{"remainingRequest":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/haopeiwei/Documents/hpw/web-board/konva-board/src/page/menu/rotate.vue?vue&type=style&index=0&id=72168a38&lang=less&scoped=true&","dependencies":[{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/src/page/menu/rotate.vue","mtime":1600055587098},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/css-loader/dist/cjs.js","mtime":1594608463058},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1592981491866},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/postcss-loader/src/index.js","mtime":1591149286800},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/less-loader/dist/cjs.js","mtime":1597049187587},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/cache-loader/dist/cjs.js","mtime":1591588454175},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/vue-loader/lib/index.js","mtime":1592981491866}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoubWVudV9yb3RhdGUgewogIGp1c3RpZnktY29udGVudDogc3BhY2UtYXJvdW5kOwp9Cg=="},{"version":3,"sources":["rotate.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkGA;AACA;AACA","file":"rotate.vue","sourceRoot":"src/page/menu","sourcesContent":["<template>\n  <div :style=\"setStyle(rotateLeft, rotateRight)\" class=\"menu_rotate\">\n    <div :style=\"!rotateLeft && 'display:none'\" @click=\"rotateTo('left')\">\n      <div class=\"icon\" v-html=\"icons.rotateLeft\"></div>\n    </div>\n    <div @click=\"rotateTo('right')\" :style=\"!rotateRight && 'display:none'\">\n      <div class=\"icon\" v-html=\"icons.rotateRight\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { fabric } from \"fabric\";\nimport icons from \"../icons.js\";\nexport default {\n  props: {\n    canvas: {\n      type: Object,\n      default: () => {}\n    },\n    currItem: {\n      type: Object,\n      default: () => {}\n    },\n    rotateRight: {\n      type: Boolean,\n      default: false\n    },\n    rotateLeft: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      icons\n    };\n  },\n  computed: {\n    setStyle() {\n      return function(left, right) {\n        if (left && right) {\n          return {\n            display: \"flex\",\n            flex: 2\n          };\n        }\n        if (!left && !right) {\n          return {\n            display: \"none\"\n          };\n        }\n\n        return {\n          display: \"flex\",\n          flex: 1\n        };\n      };\n    }\n  },\n  methods: {\n    rotateTo(direction) {\n      this.currItem.rotateTo(direction);\n      //  更新canvas的宽高\n      const { imageInfo, rotate } = this.currItem;\n      // 保持水平垂直居中\n      let wrap = document.querySelector(\"#image_canvas_wrap\");\n      if (rotate % 180 === 0) {\n        this.canvas.setWidth(imageInfo.scale.width);\n        this.canvas.setHeight(imageInfo.scale.height);\n        wrap.style[\"align-items\"] = \"center\";\n      } else {\n        this.canvas.setWidth(imageInfo.scale.height);\n        this.canvas.setHeight(imageInfo.scale.width);\n        wrap.style[\"align-items\"] = \"flex-start\";\n      }\n      // 作为组整体旋转\n      this.canvas.discardActiveObject();\n      let sel = new fabric.ActiveSelection(this.canvas.getObjects(), {\n        canvas: this.canvas,\n        cornerSize: 0,\n        hasControls: true\n      });\n      this.canvas.setActiveObject(sel);\n      direction === \"left\" ? sel.rotate(-90) : sel.rotate(90);\n      // 恢复缩放\n      let center = this.canvas.getCenter();\n      let zoomPoint = new fabric.Point(center.top, center.left);\n      this.canvas.zoomToPoint(zoomPoint, 1);\n      // 组居中\n      sel.center();\n      this.canvas.renderAll();\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.menu_rotate {\n  justify-content: space-around;\n}\n</style>\n"]}]}