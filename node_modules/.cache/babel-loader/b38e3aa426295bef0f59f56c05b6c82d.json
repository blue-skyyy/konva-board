{"remainingRequest":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/babel-loader/lib/index.js!/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/haopeiwei/Documents/hpw/web-board/konva-board/src/page/konva.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/src/page/konva.vue","mtime":1612250465918},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/cache-loader/dist/cjs.js","mtime":1591588454175},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/babel-loader/lib/index.js","mtime":1591149279866},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/cache-loader/dist/cjs.js","mtime":1591588454175},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/vue-loader/lib/index.js","mtime":1592981491866}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwudG8tanNvbiI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIi9Vc2Vycy9oYW9wZWl3ZWkvRG9jdW1lbnRzL2hwdy93ZWItYm9hcmQva29udmEtYm9hcmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgS29udmEgZnJvbSAia29udmEiOwppbXBvcnQgeyBpbWFnZUxpc3QgfSBmcm9tICIuL3V0aWwuanMiOwppbXBvcnQgSXRlbSBmcm9tICIuL0l0ZW0uanMiOwp2YXIgQ19XSURUSCA9IDgwMDsKdmFyIENfSEVJR0hUID0gNjAwOwp2YXIgbWV0aG9kcyA9IHsKICAvLyDliIfmjaLlm77niYflpI3ljp/mk43kvZwKICAvLyDliIfmjaLlt6XlhbfmoI/mqKHlvI8KICBzd2l0Y2hNb2RlOiBmdW5jdGlvbiBzd2l0Y2hNb2RlKG1vZGUpIHsKICAgIHRoaXMubW9kZSA9IG1vZGU7CgogICAgaWYgKG1vZGUgPT09ICJicnVzaCIgfHwgbW9kZSA9PT0gImVyYXNlciIpIHsKICAgICAgdGhpcy5hZGRFdmVudCgpOwogICAgICB0aGlzLmN1cnJJdGVtLmJnSW1nLmRyYWdnYWJsZShmYWxzZSk7CiAgICB9CgogICAgaWYgKG1vZGUgPT09ICJtb3Zlb2JqZWN0IikgewogICAgICB0aGlzLnJlbW92ZVN0YWdlRXZlbnRzKCk7CiAgICAgIHRoaXMuc2V0Q3Vyc29yU3R5bGUoInBvaW50ZXIiKTsKICAgICAgdGhpcy5jdXJySXRlbS5iZ0ltZy5kcmFnZ2FibGUodHJ1ZSk7CiAgICB9CgogICAgaWYgKG1vZGUgPT09ICJyZXNldCIpIHsKICAgICAgdmFyIHN0YXRlID0gdGhpcy5jdXJySXRlbS5nZXRPcmlnaW5TdGF0ZSgpOwogICAgICB0aGlzLmxvYWRDYW52YXNGcm9tSlNPTihKU09OLnBhcnNlKHN0YXRlKSk7CiAgICAgIHRoaXMuY3Vyckl0ZW0uY2xlYXJIaXN0b3J5bGlzdCgpOwogICAgICB0aGlzLmN1cnJJdGVtLnNhdmUoSlNPTi5wYXJzZShzdGF0ZSkpOwogICAgICB0aGlzLnN3aXRjaE1vZGUoImJydXNoIik7CiAgICB9CiAgfSwKICAvLyDorr7nva7pvKDmoIfmoLflvI8KICBzZXRDdXJzb3JTdHlsZTogZnVuY3Rpb24gc2V0Q3Vyc29yU3R5bGUodHlwZSkgewogICAgc3dpdGNoICh0eXBlKSB7CiAgICAgIGNhc2UgInBvaW50ZXIiOgogICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gInBvaW50ZXIiOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAiZGVmYXVsdCI6CiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSAicG9pbnRlciI7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gInBvaW50ZXIiOwogICAgICAgIGJyZWFrOwogICAgfQogIH0sCiAgLy8g6K6+572u6IOM5pmv5Zu+54mH56e75YqoCiAgbW92ZUJnSW1nOiBmdW5jdGlvbiBtb3ZlQmdJbWcoKSB7CiAgICAvLyBjb25zb2xlLmxvZygidGhpcy5zdGFnZSIsIHRoaXMuc3RhZ2UsIHRoaXMuc3RhZ2UubGlzdGVuaW5nKTsKICAgIC8vIHRoaXMuc3RhZ2UubGlzdGVuaW5nKGZhbHNlKTsKICAgIC8vIHRoaXMuaXNNb3ZpbmdCZ0ltZyA9IHRydWU7CiAgICB0aGlzLnJlbW92ZVN0YWdlRXZlbnRzKCk7CiAgICB0aGlzLmN1cnJJdGVtLmJnSW1nLmRyYWdnYWJsZSh0cnVlKTsKICAgIHRoaXMuc2V0Q3Vyc29yU3R5bGUoInBvaW50ZXIiKTsKICB9LAogIC8vIOaXi+i9rAogIHJvdGF0ZVRvOiBmdW5jdGlvbiByb3RhdGVUbyh0eXBlKSB7CiAgICBpZiAodHlwZSA9PT0gImxlZnQiKSB7CiAgICAgIHRoaXMuc3RhZ2Uucm90YXRpb24oLTkwKTsKICAgIH0KCiAgICBpZiAodHlwZSA9PT0gInJpZ2h0IikgewogICAgICB0aGlzLnN0YWdlLnJvdGF0aW9uKDkwKTsKICAgIH0KCiAgICB0aGlzLnN0YWdlLmJhdGNoRHJhdygpOwogIH0sCiAgLy8gCiAgc2V0Wm9vbTogZnVuY3Rpb24gc2V0Wm9vbSh0eXBlKSB7CiAgICB2YXIgem9vbSA9IHRoaXMuc3RhZ2UuZ2V0QXR0cigic2NhbGVYIikgfHwgMTsKCiAgICBpZiAodHlwZSA9PSAib3V0IikgewogICAgICAvLyDmlL7lpKcKICAgICAgem9vbSA9IHpvb20gKyB0aGlzLnpvb21TdGVwOwogICAgICB6b29tID0gTWF0aC5taW4oMywgem9vbSk7IC8v5pyA5aSn5piv5Y6f5p2l55qEM+WAjQogICAgfQoKICAgIGlmICh0eXBlID09PSAiaW4iKSB7CiAgICAgIHpvb20gPSB6b29tIC0gdGhpcy56b29tU3RlcDsKICAgICAgem9vbSA9IE1hdGgubWF4KDAuMSwgem9vbSk7IC8v5pyA5bCP5Li65Y6f5p2l55qEMS8xMAogICAgfQoKICAgIHRoaXMuc3RhZ2Uuc2NhbGUoewogICAgICB4OiB6b29tLAogICAgICB5OiB6b29tCiAgICB9KTsKICAgIHRoaXMuc3RhZ2UuYmF0Y2hEcmF3KCk7CiAgfSwKICAvLyDnp7vpmaRzdGFnZeS6i+S7tuebkeWQrAogIHJlbW92ZVN0YWdlRXZlbnRzOiBmdW5jdGlvbiByZW1vdmVTdGFnZUV2ZW50cygpIHsKICAgIHRoaXMuc3RhZ2Uub2ZmKCJtb3VzZWRvd24iKTsKICAgIHRoaXMuc3RhZ2Uub2ZmKCJtb3VzZW1vdmUiKTsKICAgIHRoaXMuc3RhZ2Uub2ZmKCJtb3VzZXVwIik7CiAgfSwKICAvLyDkuovku7bnm5HlkKwKICBhZGRFdmVudDogZnVuY3Rpb24gYWRkRXZlbnQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHZhciBpc1BhaW50ID0gZmFsc2U7CiAgICB2YXIgbGFzdExpbmU7CiAgICB0aGlzLnN0YWdlLm9uKCJtb3VzZWRvd24iLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlzUGFpbnQgPSB0cnVlOwoKICAgICAgdmFyIHBvcyA9IF90aGlzLnN0YWdlLmdldFBvaW50ZXJQb3NpdGlvbigpOwoKICAgICAgdmFyIG9sZFNjYWxlID0gX3RoaXMuc3RhZ2Uuc2NhbGVYKCk7CgogICAgICBsYXN0TGluZSA9IG5ldyBLb252YS5MaW5lKHsKICAgICAgICBzdHJva2U6ICIjZGY0YjI2IiwKICAgICAgICBzdHJva2VXaWR0aDogNSwKICAgICAgICBnbG9iYWxDb21wb3NpdGVPcGVyYXRpb246IF90aGlzLm1vZGUgPT09ICJicnVzaCIgPyAic291cmNlLW92ZXIiIDogImRlc3RpbmF0aW9uLW91dCIsCiAgICAgICAgcG9pbnRzOiBbcG9zLnggLyBvbGRTY2FsZSAtIF90aGlzLnN0YWdlLngoKSAvIG9sZFNjYWxlLCBwb3MueSAvIG9sZFNjYWxlIC0gX3RoaXMuc3RhZ2UueSgpIC8gb2xkU2NhbGVdCiAgICAgIH0pOwoKICAgICAgX3RoaXMuZnJlZURyYXdMYXllci5hZGQobGFzdExpbmUpOwogICAgfSk7CiAgICB0aGlzLnN0YWdlLm9uKCJtb3VzZXVwIiwgZnVuY3Rpb24gKCkgewogICAgICBpc1BhaW50ID0gZmFsc2U7CgogICAgICBfdGhpcy5zYXZlQ3Vyckl0ZW1TdGF0ZSgpOwogICAgfSk7CiAgICB0aGlzLnN0YWdlLm9uKCJtb3VzZW1vdmUiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBvbGRTY2FsZSA9IF90aGlzLnN0YWdlLnNjYWxlWCgpOwoKICAgICAgaWYgKCFpc1BhaW50KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOehruS/nee8qeaUvuWKn+iDveiDveato+W4uOS9v+eUqAoKCiAgICAgIHZhciBwb3MgPSBfdGhpcy5zdGFnZS5nZXRQb2ludGVyUG9zaXRpb24oKTsKCiAgICAgIHZhciBuZXdQb2ludHMgPSBsYXN0TGluZS5wb2ludHMoKS5jb25jYXQoW3Bvcy54IC8gb2xkU2NhbGUgLSBfdGhpcy5zdGFnZS54KCkgLyBvbGRTY2FsZSwgcG9zLnkgLyBvbGRTY2FsZSAtIF90aGlzLnN0YWdlLnkoKSAvIG9sZFNjYWxlXSk7CiAgICAgIGxhc3RMaW5lLnBvaW50cyhuZXdQb2ludHMpOwoKICAgICAgX3RoaXMuZnJlZURyYXdMYXllci5iYXRjaERyYXcoKTsKICAgIH0pOwogIH0sCiAgLy8g5Y+N5bqP5YiX5YyWCiAgbG9hZENhbnZhc0Zyb21KU09OOiBmdW5jdGlvbiBsb2FkQ2FudmFzRnJvbUpTT04oc3RhdGUpIHsKICAgIGlmICghc3RhdGUpIHJldHVybjsKICAgIHRoaXMuc3RhZ2UgPSBLb252YS5Ob2RlLmNyZWF0ZShzdGF0ZSwgImltYWdlLWNhbnZhcyIpOyAvLyDmt7vliqDog4zmma/lm74KICAgIC8vIOiDjOaZr+WbvueJh+S4jeS8muS/neWtmOWcqEpTT07lr7nosaHph4wKCiAgICB0aGlzLmJnSW1nTGF5ZXIgPSB0aGlzLnN0YWdlLmdldExheWVycygpWzBdOwogICAgdGhpcy5iZ0ltZ0xheWVyLmFkZCh0aGlzLmN1cnJJdGVtLmJnSW1nKTsKICAgIHRoaXMuYmdJbWdMYXllci5iYXRjaERyYXcoKTsgLy8gdGhpcy5iZ0ltZ0xheWVyLmJhdGNoRHJhdygpOwoKICAgIHRoaXMuZnJlZURyYXdMYXllciA9IHRoaXMuc3RhZ2UuZ2V0TGF5ZXJzKClbMV07CiAgICB0aGlzLmZyZWVEcmF3TGF5ZXIuYmF0Y2hEcmF3KCk7CiAgICB0aGlzLmlzU3dpdGNoaW5nID0gZmFsc2U7CiAgfSwKICBzYXZlQ3Vyckl0ZW1TdGF0ZTogZnVuY3Rpb24gc2F2ZUN1cnJJdGVtU3RhdGUoKSB7CiAgICBpZiAoIXRoaXMuY3Vyckl0ZW0pIHJldHVybjsKICAgIHZhciBzdGF0ZSA9IHRoaXMuc3RhZ2UudG9KU09OKCk7CiAgICB0aGlzLmN1cnJJdGVtLnNhdmUoc3RhdGUpOwogIH0sCiAgdG9OZXh0OiBmdW5jdGlvbiB0b05leHQoKSB7CiAgICAvLyB0aGlzLnNhdmVDdXJySXRlbVN0YXRlKCk7CiAgICB0aGlzLnN3aXRjaEltYWdlKHRoaXMuY3VyckluZGV4ICsgMSk7CiAgfSwKICB0b1ByZXY6IGZ1bmN0aW9uIHRvUHJldigpIHsKICAgIC8vIHRoaXMuc2F2ZUN1cnJJdGVtU3RhdGUoKTsKICAgIHRoaXMuc3dpdGNoSW1hZ2UodGhpcy5jdXJySW5kZXggLSAxKTsKICB9LAogIHRvRGF0YVVybDogZnVuY3Rpb24gdG9EYXRhVXJsKCkgewogICAgdGhpcy5pbWdVcmwgPSB0aGlzLnN0YWdlLnRvRGF0YVVSTCh7CiAgICAgIHg6IDAsCiAgICAgIHk6IDAsCiAgICAgIHdpZHRoOiBDX1dJRFRILAogICAgICBoZWlnaHQ6IENfSEVJR0hULAogICAgICBwaXhlbFJhdGlvOiAxIC8vIOWbvueJh+i0qOmHjwoKICAgIH0pOwogIH0sCiAgLy8g5Yqg6L296IOM5pmv5Zu+54mHCiAgbG9hZEJhY2tJbWFnZTogZnVuY3Rpb24gbG9hZEJhY2tJbWFnZShpdGVtT2JqKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc2xvdmUpIHsKICAgICAgdmFyIGltYWdlSW5mbyA9IGl0ZW1PYmouaW1hZ2VJbmZvOwogICAgICB2YXIgc2NhbGUgPSBpbWFnZUluZm8uc2NhbGU7CiAgICAgIEtvbnZhLkltYWdlLmZyb21VUkwoaXRlbU9iai5vcmlnaW5VcmwsIGZ1bmN0aW9uIChrSW1nKSB7CiAgICAgICAga0ltZy5zZXRBdHRycyh7CiAgICAgICAgICAvLyDorr7nva7lsYXkuK0KICAgICAgICAgIHg6IF90aGlzMi5nZXRCZ0ltZ1hZT2Zmc2V0KHNjYWxlLndpZHRoLCBudWxsKSwKICAgICAgICAgIHk6IF90aGlzMi5nZXRCZ0ltZ1hZT2Zmc2V0KG51bGwsIHNjYWxlLmhlaWdodCksCiAgICAgICAgICBpZDogImJnSW1nIiwKICAgICAgICAgIGRyYWdnYWJsZTogZmFsc2UsCiAgICAgICAgICBzb3VyY2U6IGl0ZW1PYmoub3JpZ2luVXJsLAogICAgICAgICAgd2lkdGg6IHNjYWxlLndpZHRoLAogICAgICAgICAgaGVpZ2h0OiBzY2FsZS5oZWlnaHQKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMyLmJnSW1nTGF5ZXIuYWRkKGtJbWcpOwoKICAgICAgICBfdGhpczIuYmdJbWdMYXllci5iYXRjaERyYXcoKTsKCiAgICAgICAgX3RoaXMyLmN1cnJJdGVtLmJnSW1nID0ga0ltZzsKICAgICAgICByZXNsb3ZlKCk7IC8vIGNiICYmIGNiKCk7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyDojrflj5bog4zmma/lm77niYd4eeWBj+enu+mHjwogIGdldEJnSW1nWFlPZmZzZXQ6IGZ1bmN0aW9uIGdldEJnSW1nWFlPZmZzZXQod2lkdGgsIGhlaWdodCkgewogICAgaWYgKHdpZHRoKSB7CiAgICAgIHJldHVybiBDX1dJRFRIID4gd2lkdGggPyAoQ19XSURUSCAtIHdpZHRoKSAvIDIgOiAwOwogICAgfQoKICAgIGlmIChoZWlnaHQpIHsKICAgICAgcmV0dXJuIENfSEVJR0hUID4gaGVpZ2h0ID8gKENfSEVJR0hUIC0gaGVpZ2h0KSAvIDIgOiAwOwogICAgfQogIH0sCiAgYWZ0ZXJTd2l0Y2g6IGZ1bmN0aW9uIGFmdGVyU3dpdGNoKGluZGV4LCBpdGVtT2JqKSB7CiAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICB2YXIgaXNGaXJzdFJlbmRlciA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CgogICAgaWYgKGlzRmlyc3RSZW5kZXIpIHsKICAgICAgLy8g6aaW5qyh5riy5p+TOwogICAgICBpZiAoIXRoaXMuYmdJbWdMYXllcikgewogICAgICAgIHZhciBiZ0ltZ0xheWVyID0gbmV3IEtvbnZhLkxheWVyKCk7CiAgICAgICAgdGhpcy5iZ0ltZ0xheWVyID0gYmdJbWdMYXllcjsKICAgICAgICB0aGlzLmxvYWRCYWNrSW1hZ2UoaXRlbU9iaiwgdGhpcy5pbml0RnJlZURyYXdDYW52YXMpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYmdJbWdMYXllciAmJiB0aGlzLmJnSW1nTGF5ZXIucmVtb3ZlQ2hpbGRyZW4oKTsKICAgICAgICB0aGlzLmxvYWRCYWNrSW1hZ2UoaXRlbU9iaikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczMuc2F2ZUN1cnJJdGVtU3RhdGUoKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdGhpcy5jbGVhckZyZWVEcmF3TGF5ZXIoKTsKICAgICAgdGhpcy5pc1N3aXRjaGluZyA9IGZhbHNlOwogICAgfQogIH0sCiAgLy8g6K6+572uc3RhZ2Xlrr3pq5gKICBzZXRTdGFnZVdIOiBmdW5jdGlvbiBzZXRTdGFnZVdIKHcsIGgpIHsKICAgIHRoaXMuc3RhZ2Uud2lkdGgodyk7CiAgICB0aGlzLnN0YWdlLmhlaWdodChoKTsKICB9LAogIC8vIOa4hemZpOeUu+eslOWxggogIGNsZWFyRnJlZURyYXdMYXllcjogZnVuY3Rpb24gY2xlYXJGcmVlRHJhd0xheWVyKCkgewogICAgaWYgKHRoaXMuZnJlZURyYXdMYXllcikgewogICAgICB0aGlzLmZyZWVEcmF3TGF5ZXIucmVtb3ZlQ2hpbGRyZW4oKTsKICAgICAgdGhpcy5mcmVlRHJhd0xheWVyLmRyYXcoKTsKICAgIH0KICB9LAogIC8vIOWIh+aNouWbvuWxggogIHN3aXRjaEltYWdlOiBmdW5jdGlvbiBzd2l0Y2hJbWFnZShpbmRleCkgewogICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgY29uc29sZS5sb2coIj09PT09c3dpdGNoSW1hZ2U9PT09PSIsIGluZGV4KTsKICAgIGlmIChpbmRleCA8IC0xKSByZXR1cm47CiAgICBpZiAodGhpcy5pc1N3aXRjaGluZykgcmV0dXJuOwogICAgdmFyIGltZyA9IHRoaXMuaW1hZ2VMaXN0W2luZGV4XTsKCiAgICBpZiAoIWltZykgewogICAgICBjb25zb2xlLndhcm4oIuWbvueJh+S4jeWtmOWcqCIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGl0ZW1PYmo7CgogICAgaWYgKGltZyAmJiAhaW1nLmlzUmVuZGVyKSB7CiAgICAgIHRoaXMuaXNTd2l0Y2hpbmcgPSB0cnVlOyAvLyDpppbmrKHmuLLmn5MKCiAgICAgIGl0ZW1PYmogPSBuZXcgSXRlbSh7CiAgICAgICAgdXJsOiB0aGlzLmltYWdlTGlzdFtpbmRleF0udXJsLAogICAgICAgIGNvbldIOiB7CiAgICAgICAgICB3aWR0aDogODAwLAogICAgICAgICAgaGVpZ2h0OiA2MDAKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXM0LmFmdGVyU3dpdGNoKGluZGV4LCBpdGVtT2JqLCB0cnVlKTsKICAgICAgfSk7CiAgICAgIGNvbnNvbGUubG9nKCI9PT096aaW5qyh5riy5p+TPT09PT0iKTsKICAgICAgdGhpcy5jdXJySW5kZXggPSBpbmRleDsKICAgICAgdGhpcy5jdXJySXRlbSA9IGl0ZW1PYmo7CiAgICAgIHRoaXMuaXRlbUxpc3RbdGhpcy5jdXJySW5kZXhdID0gaXRlbU9iajsKICAgICAgdGhpcy4kc2V0KHRoaXMuaW1hZ2VMaXN0LCBpbmRleCwgT2JqZWN0LmFzc2lnbih7fSwgX29iamVjdFNwcmVhZCh7fSwgdGhpcy5pbWFnZUxpc3RbaW5kZXhdKSwgewogICAgICAgIGlzUmVuZGVyOiB0cnVlCiAgICAgIH0pKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaXNTd2l0Y2hpbmcgPSB0cnVlOwogICAgICB0aGlzLmN1cnJJbmRleCA9IGluZGV4OyAvLyDpnZ7pppbmrKHmuLLmn5MKCiAgICAgIGNvbnNvbGUubG9nKCI9PT09PT3pnZ7pppbmrKHmuLLmn5M9PT09PSIpOwogICAgICB0aGlzLmN1cnJJdGVtID0gdGhpcy5pdGVtTGlzdFt0aGlzLmN1cnJJbmRleF07CiAgICAgIHZhciBsYXN0U3RhdGUgPSB0aGlzLmN1cnJJdGVtLmdldExhc3RTdGF0ZSgpOwogICAgICB0aGlzLmxvYWRDYW52YXNGcm9tSlNPTihKU09OLnBhcnNlKGxhc3RTdGF0ZSkpOwogICAgfQogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG1ldGhvZHM6IG1ldGhvZHMsCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIC8vIGZpcnN0IHdlIG5lZWQgS29udmEgY29yZSB0aGluZ3M6IHN0YWdlIGFuZCBsYXllcgogICAgdmFyIHN0YWdlID0gbmV3IEtvbnZhLlN0YWdlKHsKICAgICAgY29udGFpbmVyOiAiaW1hZ2UtY2FudmFzIiwKICAgICAgc2NhbGVZOiAxLAogICAgICBzY2FsZVg6IDEsCiAgICAgIGNlbnRlcmVkU2NhbGluZzogdHJ1ZSwKICAgICAgLy8g56Gu5a6a5LqGY2FudmFz55qE5a696auYCiAgICAgIHdpZHRoOiA4MDAsCiAgICAgIGhlaWdodDogNjAwCiAgICB9KTsKICAgIHRoaXMuc3RhZ2UgPSBzdGFnZTsgLy8g6IOM5pmv5bGCCgogICAgdGhpcy5iZ0ltZ0xheWVyID0gbmV3IEtvbnZhLkxheWVyKHsKICAgICAgaWQ6ICJiZ19pbWFnZV9sYXllciIKICAgIH0pOyAvLyDnu5jnlLvlsYIKCiAgICB0aGlzLmZyZWVEcmF3TGF5ZXIgPSBuZXcgS29udmEuTGF5ZXIoewogICAgICBpZDogImZyZWVfZHJhd19sYXllciIsCiAgICAgIGJhY2tncm91bmRDb2xvcjogInJlZCIKICAgIH0pOwogICAgdGhpcy5zdGFnZS5hZGQodGhpcy5iZ0ltZ0xheWVyKTsKICAgIHRoaXMuc3RhZ2UuYWRkKHRoaXMuZnJlZURyYXdMYXllcik7CiAgICB0aGlzLmFkZEV2ZW50KCk7IC8vIOe7hOijheaVsOaNruagvOW8jwoKICAgIHRoaXMuaW1hZ2VMaXN0ID0gdGhpcy5pbWFnZUxpc3QubWFwKGZ1bmN0aW9uIChkKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgaXNSZW5kZXI6IGZhbHNlLAogICAgICAgIHVybDogZAogICAgICB9OwogICAgfSk7CiAgICB0aGlzLnRvTmV4dCgpOyAvLyB0aGlzLmluaXRGcmVlRHJhd0NhbnZhcygpOwogICAgLy8gdGhpcy4oKTsKICAgIC8vIOWIneWni+WMluaXtuWAmemcgOimgeW8guatpQogICAgLy8gc2V0VGltZW91dCgoKSA9PiB7fSwgMTAwKTsKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBtb2RlOiAiYnJ1c2giLAogICAgICBpc01vdmluZ0JnSW1nOiBmYWxzZSwKICAgICAgem9vbVN0ZXA6IDAuMSwKICAgICAgc3RhZ2U6IG51bGwsCiAgICAgIGltZ1VybDogbnVsbCwKICAgICAgaW1hZ2VMaXN0OiBpbWFnZUxpc3QsCiAgICAgIGN1cnJJbmRleDogLTEsCiAgICAgIGN1cnJJdGVtOiBudWxsLAogICAgICBpdGVtTGlzdDogW10sCiAgICAgIGNvbldIOiB7CiAgICAgICAgd2lkdGg6IDgwMCwKICAgICAgICBoZWlnaHQ6IDYwMAogICAgICB9LAogICAgICBmcmVlRHJhd0xheWVyOiBudWxsLAogICAgICBiZ0ltZ0xheWVyOiBudWxsLAogICAgICBpc1N3aXRjaGluZzogZmFsc2UKICAgIH07CiAgfSwKICBjb21wb25lbnRzOiB7fQp9Ow=="},{"version":3,"sources":["konva.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div id=\"image-decorator-wrap\">\n      <div id=\"image-canvas\"></div>\n    </div>\n\n    <select id=\"tool\">\n      <option value=\"brush\">Brush</option>\n      <option value=\"eraser\">Eraser</option>\n    </select>\n    <button @click=\"switchMode('brush')\">画笔模式</button>\n    <button @click=\"switchMode('eraser')\">橡皮擦模式</button>\n    <button @click=\"switchMode('moveobject')\">移动背景图片</button>\n    <button @click=\"switchMode('reset')\">重置</button>\n    <img :src=\"imgUrl\" class=\"img\" />\n    <button @click=\"toDataUrl\">点我下载</button>\n    <button @click=\"toNext\">下一张</button>\n    <button @click=\"toPrev\">上一张</button>\n    <button>{{ currIndex }}</button>\n    <button @click=\"setZoom('out')\">放大</button>\n    <button @click=\"setZoom('in')\">缩小</button>\n    <button @click=\"rotateTo('left')\">向左</button>\n    <button @click=\"rotateTo('right')\">向右</button>\n  </div>\n</template>\n\n<script>\nimport Konva from \"konva\";\nimport { imageList } from \"./util.js\";\nimport Item from \"./Item.js\";\n\nconst C_WIDTH = 800;\nconst C_HEIGHT = 600;\nconst methods = {\n  // 切换图片复原操作\n\n  // 切换工具栏模式\n  switchMode(mode) {\n    this.mode = mode;\n    if (mode === \"brush\" || mode === \"eraser\") {\n      this.addEvent();\n      this.currItem.bgImg.draggable(false);\n    }\n    if (mode === \"moveobject\") {\n      this.removeStageEvents();\n      this.setCursorStyle(\"pointer\");\n      this.currItem.bgImg.draggable(true);\n    }\n\n    if (mode === \"reset\") {\n      let state = this.currItem.getOriginState();\n      this.loadCanvasFromJSON(JSON.parse(state));\n      this.currItem.clearHistorylist();\n      this.currItem.save(JSON.parse(state));\n      this.switchMode(\"brush\")\n    }\n  },\n  // 设置鼠标样式\n  setCursorStyle(type) {\n    switch (type) {\n      case \"pointer\":\n        document.body.style.cursor = \"pointer\";\n        break;\n      case \"default\":\n        document.body.style.cursor = \"pointer\";\n        break;\n      default:\n        document.body.style.cursor = \"pointer\";\n        break;\n    }\n  },\n  // 设置背景图片移动\n  moveBgImg() {\n    // console.log(\"this.stage\", this.stage, this.stage.listening);\n    // this.stage.listening(false);\n    // this.isMovingBgImg = true;\n    this.removeStageEvents();\n    this.currItem.bgImg.draggable(true);\n    this.setCursorStyle(\"pointer\");\n  },\n  // 旋转\n  rotateTo(type) {\n    if (type === \"left\") {\n      this.stage.rotation(-90);\n    }\n    if (type === \"right\") {\n      this.stage.rotation(90);\n    }\n    this.stage.batchDraw();\n  },\n  // \n  setZoom(type) {\n    let zoom = this.stage.getAttr(\"scaleX\") || 1;\n    if (type == \"out\") {\n      // 放大\n      zoom = zoom + this.zoomStep;\n      zoom = Math.min(3, zoom); //最大是原来的3倍\n    }\n    if (type === \"in\") {\n      zoom = zoom - this.zoomStep;\n      zoom = Math.max(0.1, zoom); //最小为原来的1/10\n    }\n    this.stage.scale({\n      x: zoom,\n      y: zoom\n    });\n    this.stage.batchDraw();\n  },\n  // 移除stage事件监听\n  removeStageEvents() {\n    this.stage.off(\"mousedown\");\n    this.stage.off(\"mousemove\");\n    this.stage.off(\"mouseup\");\n  },\n  // 事件监听\n  addEvent() {\n    let isPaint = false;\n    let lastLine;\n    this.stage.on(\"mousedown\", () => {\n      isPaint = true;\n      let pos = this.stage.getPointerPosition();\n      let oldScale = this.stage.scaleX();\n      lastLine = new Konva.Line({\n        stroke: \"#df4b26\",\n        strokeWidth: 5,\n        globalCompositeOperation:\n          this.mode === \"brush\" ? \"source-over\" : \"destination-out\",\n        points: [\n          pos.x / oldScale - this.stage.x() / oldScale,\n          pos.y / oldScale - this.stage.y() / oldScale\n        ]\n      });\n      this.freeDrawLayer.add(lastLine);\n    });\n    this.stage.on(\"mouseup\", () => {\n      isPaint = false;\n      this.saveCurrItemState();\n    });\n    this.stage.on(\"mousemove\", () => {\n      let oldScale = this.stage.scaleX();\n      if (!isPaint) {\n        return;\n      }\n      // 确保缩放功能能正常使用\n      const pos = this.stage.getPointerPosition();\n      let newPoints = lastLine\n        .points()\n        .concat([\n          pos.x / oldScale - this.stage.x() / oldScale,\n          pos.y / oldScale - this.stage.y() / oldScale\n        ]);\n      lastLine.points(newPoints);\n      this.freeDrawLayer.batchDraw();\n    });\n  },\n  // 反序列化\n  loadCanvasFromJSON(state) {\n    if (!state) return;\n    this.stage = Konva.Node.create(state, \"image-canvas\");\n    // 添加背景图\n    // 背景图片不会保存在JSON对象里\n    this.bgImgLayer = this.stage.getLayers()[0];\n    this.bgImgLayer.add(this.currItem.bgImg)\n    this.bgImgLayer.batchDraw();\n    // this.bgImgLayer.batchDraw();\n    this.freeDrawLayer = this.stage.getLayers()[1];\n    this.freeDrawLayer.batchDraw();\n    this.isSwitching = false;\n\n  },\n  saveCurrItemState() {\n    if (!this.currItem) return;\n    let state = this.stage.toJSON();\n    this.currItem.save(state);\n  },\n  toNext() {\n    // this.saveCurrItemState();\n    this.switchImage(this.currIndex + 1);\n  },\n  toPrev() {\n    // this.saveCurrItemState();\n    this.switchImage(this.currIndex - 1);\n  },\n  toDataUrl() {\n    this.imgUrl = this.stage.toDataURL({\n      x: 0,\n      y: 0,\n      width: C_WIDTH,\n      height: C_HEIGHT,\n      pixelRatio: 1, // 图片质量\n    });\n  },\n  // 加载背景图片\n  loadBackImage(itemObj) {\n    return new Promise((reslove) => {\n      const { imageInfo } = itemObj;\n      const { scale } = imageInfo;\n      Konva.Image.fromURL(itemObj.originUrl, (kImg) => {\n        kImg.setAttrs({\n          // 设置居中\n          x: this.getBgImgXYOffset(scale.width, null),\n          y: this.getBgImgXYOffset(null, scale.height),\n          id: \"bgImg\",\n          draggable: false,\n          source: itemObj.originUrl,\n          width: scale.width,\n          height: scale.height\n        });\n        this.bgImgLayer.add(kImg);\n        this.bgImgLayer.batchDraw();\n        this.currItem.bgImg = kImg;\n        reslove();\n        // cb && cb();\n      });\n    })\n  },\n  // 获取背景图片xy偏移量\n  getBgImgXYOffset(width, height) {\n    if (width) {\n      return C_WIDTH > width ? (C_WIDTH - width) / 2 : 0;\n    }\n    if (height) {\n      return C_HEIGHT > height ? (C_HEIGHT - height) / 2 : 0;\n    }\n  },\n\n  afterSwitch(index, itemObj, isFirstRender = false) {\n    if (isFirstRender) {\n      // 首次渲染;\n      if (!this.bgImgLayer) {\n        let bgImgLayer = new Konva.Layer();\n        this.bgImgLayer = bgImgLayer;\n        this.loadBackImage(itemObj, this.initFreeDrawCanvas);\n      } else {\n        this.bgImgLayer && this.bgImgLayer.removeChildren();\n        this.loadBackImage(itemObj).then(() => {\n          this.saveCurrItemState();\n        });\n      \n      }\n      this.clearFreeDrawLayer();\n      this.isSwitching = false;\n    }\n  },\n  // 设置stage宽高\n  setStageWH(w, h) {\n    this.stage.width(w);\n    this.stage.height(h);\n  },\n  // 清除画笔层\n  clearFreeDrawLayer() {\n    if (this.freeDrawLayer) {\n      this.freeDrawLayer.removeChildren();\n      this.freeDrawLayer.draw();\n    }\n  },\n  // 切换图层\n  switchImage(index) {\n    console.log(\"=====switchImage=====\", index);\n    if (index < -1) return;\n    if (this.isSwitching) return;\n    let img = this.imageList[index];\n    if (!img) {\n      console.warn(\"图片不存在\");\n      return;\n    }\n    let itemObj;\n    if (img && !img.isRender) {\n      this.isSwitching = true;\n      // 首次渲染\n      itemObj = new Item(\n        {\n          url: this.imageList[index].url,\n          conWH: { width: 800, height: 600 }\n        },\n        () => this.afterSwitch(index, itemObj, true)\n      );\n      console.log(\"====首次渲染=====\")\n      this.currIndex = index;\n      this.currItem = itemObj;\n      this.itemList[this.currIndex] = itemObj;\n      this.$set(this.imageList, index, Object.assign({}, {...this.imageList[index]}, {isRender: true}))\n    } else {\n      this.isSwitching = true;\n      this.currIndex = index;\n      // 非首次渲染\n      console.log(\"======非首次渲染=====\");\n      this.currItem = this.itemList[this.currIndex];\n      let lastState = this.currItem.getLastState();\n      this.loadCanvasFromJSON(JSON.parse(lastState));\n    }\n  }\n};\nexport default {\n  methods,\n  mounted() {\n    // first we need Konva core things: stage and layer\n    let stage = new Konva.Stage({\n      container: \"image-canvas\",\n      scaleY: 1,\n      scaleX: 1,\n      centeredScaling: true,\n      // 确定了canvas的宽高\n      width: 800,\n      height: 600\n    });\n\n    this.stage = stage;\n\n    // 背景层\n    this.bgImgLayer = new Konva.Layer({\n      id: \"bg_image_layer\"\n    });\n\n    // 绘画层\n    this.freeDrawLayer = new Konva.Layer({\n      id: \"free_draw_layer\",\n      backgroundColor: \"red\"\n    });\n\n    this.stage.add(this.bgImgLayer);\n    this.stage.add(this.freeDrawLayer);\n\n    this.addEvent();\n\n    // 组装数据格式\n    this.imageList = this.imageList.map((d) => {\n      return {\n        isRender: false,\n        url: d\n      };\n    });\n    this.toNext();\n    // this.initFreeDrawCanvas();\n    // this.();\n\n    // 初始化时候需要异步\n    // setTimeout(() => {}, 100);\n  },\n  data() {\n    return {\n      mode: \"brush\",\n      isMovingBgImg: false,\n      zoomStep: 0.1,\n      stage: null,\n      imgUrl: null,\n      imageList: imageList,\n      currIndex: -1,\n      currItem: null,\n      itemList: [],\n      conWH: { width: 800, height: 600 },\n      freeDrawLayer: null,\n      bgImgLayer: null,\n      isSwitching: false\n    };\n  },\n  components: {}\n};\n</script>\n\n<style lang=\"less\" scoped>\n#image-decorator-wrap {\n  border: 1px solid red;\n  width: 800px;\n  height: 600px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 0 auto;\n  overflow: hidden;\n\n  #image-canvas {\n    border: 1px solid yellow;\n  }\n  .img {\n    margin-top: 20px;\n    border: 1px solid blue;\n  }\n}\n</style>\n"],"sourceRoot":"src/page"}]}