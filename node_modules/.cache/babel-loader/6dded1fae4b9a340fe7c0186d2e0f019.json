{"remainingRequest":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/babel-loader/lib/index.js!/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/haopeiwei/Documents/hpw/web-board/konva-board/src/page/menu/eraser.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/src/page/menu/eraser.vue","mtime":1600076897247},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/cache-loader/dist/cjs.js","mtime":1591588454175},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/babel-loader/lib/index.js","mtime":1591149279866},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/cache-loader/dist/cjs.js","mtime":1591588454175},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/vue-loader/lib/index.js","mtime":1592981491866}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGljb25zIGZyb20gIi4uL2ljb25zLmpzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJlcmFzZXIiLAogIHByb3BzOiB7CiAgICBtb2RlOiB7CiAgICAgIGRlZmF1bHQ6ICIiLAogICAgICB0eXBlOiBTdHJpbmcKICAgIH0sCiAgICBjYW52YXM6IHsKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7fSwKICAgICAgdHlwZTogT2JqZWN0CiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZXJhc2VySWNvbjogaWNvbnMuZXJhc2VyLAogICAgICBpc1Nob3c6IGZhbHNlLAogICAgICBob3Zlck9iajogbnVsbAogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICBtb2RlOiBmdW5jdGlvbiBtb2RlKG5ld21vZGUpIHsKICAgICAgaWYgKG5ld21vZGUgPT09ICJlcmFzZXIiKSB7CiAgICAgICAgdGhpcy5lcmFzZXJJY29uID0gaWNvbnMuYWN0aXZlRXJhc2VyOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZXJhc2VySWNvbiA9IGljb25zLmVyYXNlcjsKICAgICAgfQogICAgfSwKICAgIGNhbnZhczogZnVuY3Rpb24gY2FudmFzKG5ld0NhbnZhcykgewogICAgICBuZXdDYW52YXMub24oIm1vdXNlOmRvd24iLCB0aGlzLmRlYWxNb3VzZWRvd24pOwogICAgICBuZXdDYW52YXMub24oIm9iamVjdDpvdmVyIiwgdGhpcy5kZWFsTW91c2VvdmVyKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGRlYWxNb3VzZWRvd246IGZ1bmN0aW9uIGRlYWxNb3VzZWRvd24oZSkgewogICAgICAvLyDmqaHnmq7mqKHlvI/vvIznp7vpmaTpgInkuK3nmoTlhYPntKAKICAgICAgaWYgKHRoaXMubW9kZSA9PT0gImVyYXNlciIgJiYgZS50YXJnZXQgPT09IHRoaXMuaG92ZXJPYmopIHsKICAgICAgICB0aGlzLmNhbnZhcy5yZW1vdmUodGhpcy5ob3Zlck9iaik7CiAgICAgICAgdGhpcy5ob3Zlck9iaiA9IG51bGw7CiAgICAgIH0KICAgIH0sCiAgICBkZWFsTW91c2VvdmVyOiBmdW5jdGlvbiBkZWFsTW91c2VvdmVyKGUpIHsKICAgICAgLy8g5Yik5pat5piv5ZCm5piv5qmh55qu5qih5byPCiAgICAgIGlmICh0aGlzLm1vZGUgIT09ICJlcmFzZXIiKSByZXR1cm47CiAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDsgLy8g5Y+W5raI5LmL5YmNaG92ZXJPYmrnmoRob3ZlcuaViOaenAoKICAgICAgaWYgKHRoaXMuaG92ZXJPYmopIHsKICAgICAgICB0aGlzLmhvdmVyT2JqLnN0cm9rZSA9IHRoaXMuaG92ZXJPYmoub3JpZ1N0cm9rZTsKICAgICAgICB0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKTsKICAgICAgfSAvLyBob3ZlcuWvueixoeS4uueslOWIkgoKCiAgICAgIGlmICh0YXJnZXQuZ2V0KCJ0eXBlIikgPT09ICJwYXRoIikgewogICAgICAgIHRhcmdldC5vcmlnU3Ryb2tlID0gdGFyZ2V0LnN0cm9rZTsgLy8g6auY5Lqu5b6F5Yig6Zmk55qE56yU5YiSCgogICAgICAgIHRhcmdldC5zdHJva2UgPSAiIzk5OSI7CiAgICAgICAgdGhpcy5ob3Zlck9iaiA9IHRhcmdldDsKICAgICAgICB0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKTsKICAgICAgfQogICAgfSwKICAgIGRlYWxDbGljazogZnVuY3Rpb24gZGVhbENsaWNrKCkgewogICAgICB0aGlzLiRlbWl0KCJjbGljayIpOwogICAgfSAvLyB0aGlzLmNhbnZhcy5pc0RyYXdpbmdNb2RlID0gdHJ1ZTsKICAgIC8vIGNvbnN0IEVyYXNlckJydXNoID0gZmFicmljLnV0aWwuY3JlYXRlQ2xhc3MoZmFicmljLlBlbmNpbEJydXNoLCB7CiAgICAvLyAgIF9maW5hbGl6ZUFuZEFkZFBhdGgoKSB7CiAgICAvLyAgICAgY29uc29sZS5sb2coIkVyYXNlckJydXNoIik7CiAgICAvLyAgICAgbGV0IGN0eCA9IHRoaXMuY2FudmFzLmNvbnRleHRUb3A7CiAgICAvLyAgICAgY3R4LmNsb3NlUGF0aCgpOwogICAgLy8gICAgIGlmICh0aGlzLmRlY2ltYXRlKSB7CiAgICAvLyAgICAgICB0aGlzLl9wb2ludHMgPSB0aGlzLmRlY2ltYXRlUG9pbnRzKHRoaXMuX3BvaW50cywgdGhpcy5kZWNpbWF0ZSk7CiAgICAvLyAgICAgfQogICAgLy8gICAgIGxldCBwYXRoRGF0YSA9IHRoaXMuY29udmVydFBvaW50c1RvU1ZHUGF0aCh0aGlzLl9wb2ludHMpLmpvaW4oIiIpOwogICAgLy8gICAgIC8vIGNvbnNvbGUubG9nKCJwYXRoRGF0YSIsIHBhdGhEYXRhKTsKICAgIC8vICAgICBpZiAocGF0aERhdGEgPT09ICJNIDAgMCBRIDAgMCAwIDAgTCAwIDAiKSB7CiAgICAvLyAgICAgICAvLyBkbyBub3QgY3JlYXRlIDAgd2lkdGgvaGVpZ2h0IHBhdGhzLCBhcyB0aGV5IGFyZQogICAgLy8gICAgICAgLy8gcmVuZGVyZWQgaW5jb25zaXN0ZW50bHkgYWNyb3NzIGJyb3dzZXJzCiAgICAvLyAgICAgICAvLyBGaXJlZm94IDQsIGZvciBleGFtcGxlLCByZW5kZXJzIGEgZG90LAogICAgLy8gICAgICAgLy8gd2hlcmVhcyBDaHJvbWUgMTAgcmVuZGVycyBub3RoaW5nCiAgICAvLyAgICAgICB0aGlzLmNhbnZhcy5yZXF1ZXN0UmVuZGVyQWxsKCk7CiAgICAvLyAgICAgICByZXR1cm47CiAgICAvLyAgICAgfQogICAgLy8gICAgIC8vIHVzZSBnbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gdG8gJ2Zha2UnIGVyYXNlcgogICAgLy8gICAgIGxldCBwYXRoID0gdGhpcy5jcmVhdGVQYXRoKHBhdGhEYXRhKTsKICAgIC8vICAgICAvLyBjb25zb2xlLmxvZygicGF0aCIsIHBhdGgpOwogICAgLy8gICAgIHBhdGguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gImRlc3RpbmF0aW9uLW91dCI7CiAgICAvLyAgICAgcGF0aC5zZWxlY3RhYmxlID0gZmFsc2U7CiAgICAvLyAgICAgcGF0aC5ldmVudGVkID0gZmFsc2U7CiAgICAvLyAgICAgcGF0aC5hYnNvbHV0ZVBvc2l0aW9uZWQgPSB0cnVlOwogICAgLy8gICAgIHBhdGguc2V0KHsKICAgIC8vICAgICAgIG5hbWVUeXBlOiAiZXJhc2VyIiwKICAgIC8vICAgICAgIGdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbjogImRlc3RpbmF0aW9uLW91dCIsCiAgICAvLyAgICAgICBvcGFjaXR5OiAwCiAgICAvLyAgICAgICAvLyBzdHJva2U6ICJncmVlbiIsCiAgICAvLyAgICAgICAvLyBzdHJva2VXaWR0aDogMjAKICAgIC8vICAgICB9KTsKCiAgfQp9Ow=="},{"version":3,"sources":["eraser.vue"],"names":[],"mappings":";;;;;;;;;AAUA,OAAA,KAAA,MAAA,aAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,QADA;AAEA,EAAA,KAAA,EAAA;AACA,IAAA,IAAA,EAAA;AACA,MAAA,OAAA,EAAA,EADA;AAEA,MAAA,IAAA,EAAA;AAFA,KADA;AAKA,IAAA,MAAA,EAAA;AACA,MAAA,OAAA,EAAA,oBAAA,CAAA,CADA;AAEA,MAAA,IAAA,EAAA;AAFA;AALA,GAFA;AAYA,EAAA,IAZA,kBAYA;AACA,WAAA;AACA,MAAA,UAAA,EAAA,KAAA,CAAA,MADA;AAEA,MAAA,MAAA,EAAA,KAFA;AAGA,MAAA,QAAA,EAAA;AAHA,KAAA;AAKA,GAlBA;AAoBA,EAAA,KAAA,EAAA;AACA,IAAA,IADA,gBACA,OADA,EACA;AACA,UAAA,OAAA,KAAA,QAAA,EAAA;AACA,aAAA,UAAA,GAAA,KAAA,CAAA,YAAA;AACA,OAFA,MAEA;AACA,aAAA,UAAA,GAAA,KAAA,CAAA,MAAA;AACA;AACA,KAPA;AAQA,IAAA,MARA,kBAQA,SARA,EAQA;AACA,MAAA,SAAA,CAAA,EAAA,CAAA,YAAA,EAAA,KAAA,aAAA;AACA,MAAA,SAAA,CAAA,EAAA,CAAA,aAAA,EAAA,KAAA,aAAA;AACA;AAXA,GApBA;AAiCA,EAAA,OAAA,EAAA;AACA,IAAA,aADA,yBACA,CADA,EACA;AACA;AACA,UAAA,KAAA,IAAA,KAAA,QAAA,IAAA,CAAA,CAAA,MAAA,KAAA,KAAA,QAAA,EAAA;AACA,aAAA,MAAA,CAAA,MAAA,CAAA,KAAA,QAAA;AACA,aAAA,QAAA,GAAA,IAAA;AACA;AACA,KAPA;AAQA,IAAA,aARA,yBAQA,CARA,EAQA;AACA;AACA,UAAA,KAAA,IAAA,KAAA,QAAA,EAAA;AAEA,UAAA,MAAA,GAAA,CAAA,CAAA,MAAA,CAJA,CAKA;;AACA,UAAA,KAAA,QAAA,EAAA;AACA,aAAA,QAAA,CAAA,MAAA,GAAA,KAAA,QAAA,CAAA,UAAA;AACA,aAAA,MAAA,CAAA,SAAA;AACA,OATA,CAWA;;;AACA,UAAA,MAAA,CAAA,GAAA,CAAA,MAAA,MAAA,MAAA,EAAA;AACA,QAAA,MAAA,CAAA,UAAA,GAAA,MAAA,CAAA,MAAA,CADA,CAEA;;AACA,QAAA,MAAA,CAAA,MAAA,GAAA,MAAA;AACA,aAAA,QAAA,GAAA,MAAA;AACA,aAAA,MAAA,CAAA,SAAA;AACA;AACA,KA3BA;AA4BA,IAAA,SA5BA,uBA4BA;AACA,WAAA,KAAA,CAAA,OAAA;AACA,KA9BA,CA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAhEA;AAjCA,CAAA","sourcesContent":["<template>\n  <div>\n    <div class=\"menu_eraser\">\n      <div @click=\"dealClick\" v-html=\"eraserIcon\" class=\"eraser_icon\"></div>\n      <div class=\"color_box\" v-show=\"isShow\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport icons from \"../icons.js\";\n\nexport default {\n  name: \"eraser\",\n  props: {\n    mode: {\n      default: \"\",\n      type: String\n    },\n    canvas: {\n      default: () => {},\n      type: Object\n    }\n  },\n  data() {\n    return {\n      eraserIcon: icons.eraser,\n      isShow: false,\n      hoverObj: null\n    };\n  },\n\n  watch: {\n    mode(newmode) {\n      if (newmode === \"eraser\") {\n        this.eraserIcon = icons.activeEraser;\n      } else {\n        this.eraserIcon = icons.eraser;\n      }\n    },\n    canvas(newCanvas) {\n      newCanvas.on(\"mouse:down\", this.dealMousedown);\n      newCanvas.on(\"object:over\", this.dealMouseover);\n    }\n  },\n  methods: {\n    dealMousedown(e) {\n      // 橡皮模式，移除选中的元素\n      if (this.mode === \"eraser\" && e.target === this.hoverObj) {\n        this.canvas.remove(this.hoverObj);\n        this.hoverObj = null;\n      }\n    },\n    dealMouseover(e) {\n      // 判断是否是橡皮模式\n      if (this.mode !== \"eraser\") return;\n\n      let target = e.target;\n      // 取消之前hoverObj的hover效果\n      if (this.hoverObj) {\n        this.hoverObj.stroke = this.hoverObj.origStroke;\n        this.canvas.renderAll();\n      }\n\n      // hover对象为笔划\n      if (target.get(\"type\") === \"path\") {\n        target.origStroke = target.stroke;\n        // 高亮待删除的笔划\n        target.stroke = \"#999\";\n        this.hoverObj = target;\n        this.canvas.renderAll();\n      }\n    },\n    dealClick() {\n      this.$emit(\"click\");\n    }\n    // this.canvas.isDrawingMode = true;\n    // const EraserBrush = fabric.util.createClass(fabric.PencilBrush, {\n    //   _finalizeAndAddPath() {\n    //     console.log(\"EraserBrush\");\n    //     let ctx = this.canvas.contextTop;\n    //     ctx.closePath();\n    //     if (this.decimate) {\n    //       this._points = this.decimatePoints(this._points, this.decimate);\n    //     }\n    //     let pathData = this.convertPointsToSVGPath(this._points).join(\"\");\n    //     // console.log(\"pathData\", pathData);\n    //     if (pathData === \"M 0 0 Q 0 0 0 0 L 0 0\") {\n    //       // do not create 0 width/height paths, as they are\n    //       // rendered inconsistently across browsers\n    //       // Firefox 4, for example, renders a dot,\n    //       // whereas Chrome 10 renders nothing\n    //       this.canvas.requestRenderAll();\n    //       return;\n    //     }\n\n    //     // use globalCompositeOperation to 'fake' eraser\n    //     let path = this.createPath(pathData);\n    //     // console.log(\"path\", path);\n    //     path.globalCompositeOperation = \"destination-out\";\n    //     path.selectable = false;\n    //     path.evented = false;\n    //     path.absolutePositioned = true;\n    //     path.set({\n    //       nameType: \"eraser\",\n    //       globalCompositeOperation: \"destination-out\",\n    //       opacity: 0\n    //       // stroke: \"green\",\n    //       // strokeWidth: 20\n    //     });\n  }\n};\n</script>\n"],"sourceRoot":"src/page/menu"}]}