{"remainingRequest":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/babel-loader/lib/index.js!/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/haopeiwei/Documents/hpw/web-board/konva-board/src/page/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/src/page/index.vue","mtime":1600414783631},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/cache-loader/dist/cjs.js","mtime":1591588454175},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/babel-loader/lib/index.js","mtime":1591149279866},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/cache-loader/dist/cjs.js","mtime":1591588454175},{"path":"/Users/haopeiwei/Documents/hpw/web-board/konva-board/node_modules/vue-loader/lib/index.js","mtime":1592981491866}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwudG8tanNvbiI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IGZhYnJpYyB9IGZyb20gImZhYnJpYyI7CmltcG9ydCBfIGZyb20gImxvZGFzaCI7CmltcG9ydCB7IGltYWdlTGlzdCB9IGZyb20gIi4vdXRpbC5qcyI7CmltcG9ydCBJdGVtIGZyb20gIi4vSXRlbSI7CmltcG9ydCBNZW51RHJhZyBmcm9tICIuL21lbnUvZHJhZy52dWUiOwppbXBvcnQgTWVudVBlbmNpbCBmcm9tICIuL21lbnUvcGVuY2lsLnZ1ZSI7CmltcG9ydCBNZW51Wm9vbSBmcm9tICIuL21lbnUvem9vbS52dWUiOwppbXBvcnQgTWVudVJlc3RvcmUgZnJvbSAiLi9tZW51L3Jlc3RvcmUudnVlIjsKaW1wb3J0IE1lbnVSb3RhdGUgZnJvbSAiLi9tZW51L3JvdGF0ZS52dWUiOwppbXBvcnQgTWVudUNvbG9yIGZyb20gIi4vbWVudS9jb2xvci52dWUiOwppbXBvcnQgTWVudUVyYXNlciBmcm9tICIuL21lbnUvZXJhc2VyLnZ1ZSI7CmltcG9ydCBNZW51U3dpdGNoSW1hZ2UgZnJvbSAiLi9tZW51L3N3aXRjaEltYWdlLnZ1ZSI7CmltcG9ydCBNZW51RG93bmxvYWQgZnJvbSAiLi9tZW51L2Rvd25sb2FkLnZ1ZSI7CmltcG9ydCBNZW51VW5kbyBmcm9tICIuL21lbnUvdW5kby52dWUiOyAvLyBmYWJyaWMuT2JqZWN0LnByb3RvdHlwZS5zZXQoewovLyAgIGJvcmRlckNvbG9yOiAicmVkIiwKLy8gICBjb3JuZXJDb2xvcjogInJlZCIsIC8v5r+A5rS754q25oCB6KeS6JC95Zu+5qCH55qE5aGr5YWF6aKc6ImyCi8vICAgY29ybmVyU3Ryb2tlQ29sb3I6ICIiLCAvL+a/gOa0u+eKtuaAgeinkuiQveWbvuagh+eahOi+ueahhuminOiJsgovLyAgIGJvcmRlck9wYWNpdHlXaGVuTW92aW5nOiAxLAovLyAgIGJvcmRlclNjYWxlRmFjdG9yOiAxLAovLyAgIGNvcm5lclNpemU6IDgsCi8vICAgY29ybmVyU3R5bGU6ICJyZWN0IiwgLy9yZWN0LGNpcmNsZQovLyAgIGNlbnRlcmVkU2NhbGluZzogZmFsc2UsIC8v6KeS6JC95pS+5aSn57yp5bCP5piv5ZCm5piv5Lul5Zu+5b2i5Lit5b+D5Li65pS+5aSn5Y6f54K5Ci8vICAgY2VudGVyZWRSb3RhdGlvbjogdHJ1ZSwgLy/ml4vovazmjInpkq7ml4vovazmmK/lkKbmmK/lt6bkuIrop5LkuLrlnIblv4Pml4vovawKLy8gICB0cmFuc3BhcmVudENvcm5lcnM6IGZhbHNlLCAvL+a/gOa0u+eKtuaAgeinkuiQveeahOWbvuagh+aYr+WQpumAj+aYjgovLyAgIHJvdGF0aW5nUG9pbnRPZmZzZXQ6IDIwLCAvL+aXi+i9rOi3neaXi+i9rOS9k+eahOi3neemuwovLyAgIG9yaWdpblg6ICJjZW50ZXIiLAovLyAgIG9yaWdpblk6ICJjZW50ZXIiLAovLyAgIGxvY2tVbmlTY2FsaW5nOiBmYWxzZSwgLy/lj6rmmL7npLrlm5vop5LnmoTmk43kvZwKLy8gICBoYXNSb3RhdGluZ1BvaW50OiB0cnVlLCAvL+aYr+WQpuaYvuekuuaXi+i9rOaMiemSrgovLyAgIHNlbGVjdGlvbkRhc2hBcnJheTogWzUsIDVdCi8vIH0pOwoKdmFyIG1ldGhvZHMgPSB7CiAgLy8g5bu26L+f5a2Y5YKoCiAgcHJlU2F2ZTogXy5kZWJvdW5jZShmdW5jdGlvbiAoKSB7CiAgICB0aGlzLnNhdmVDdXJySXRlbVN0YXRlKCk7CiAgfSwgNDAwMCksCiAgLy8g6LCD5pW05b+r54Wn54q25oCBCiAgZml4U3RhdGU6IGZ1bmN0aW9uIGZpeFN0YXRlKHN0YXRlLCBfcmVmKSB7CiAgICB2YXIgc2NhbGVYID0gX3JlZi5zY2FsZVgsCiAgICAgICAgc2NhbGVZID0gX3JlZi5zY2FsZVk7CgogICAgaWYgKCFzdGF0ZSkgewogICAgICBjb25zb2xlLmVycm9yKCJzdGF0ZSBpcyByZXF1aXJlZCIpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdmFyIHN0YXRlT2JqID0gSlNPTi5wYXJzZShzdGF0ZSk7CiAgICBzdGF0ZU9iai5vYmplY3RzWzBdLnNjYWxlWSA9IHNjYWxlWTsKICAgIHN0YXRlT2JqLm9iamVjdHNbMF0uc2NhbGVYID0gc2NhbGVYOwogICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHN0YXRlT2JqKTsKICB9LAogIC8vIOWvvOWHuuWbvueJh+eahOaWueazlQogIGV4cG9ydEltYWdlRnVuYzogZnVuY3Rpb24gZXhwb3J0SW1hZ2VGdW5jKGl0ZW0pIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNsb3ZlLCByZWplY3QpIHsKICAgICAgaWYgKCFpdGVtKSByZWplY3QoIml0ZW0gaXMgcmVxdWlyZWQsIGl0ZW06IiwgaXRlbSk7IC8vIHRoaXMuc2F2ZUN1cnJJdGVtU3RhdGUoKTsgLy8g5a+85Ye65pe25YCZ6buY6K6k5L+d5a2Y5LiA5qyh77yM6YG/5YWN54q25oCB6YGX5ryPCgogICAgICB2YXIgcm90YXRlID0gaXRlbS5yb3RhdGUsCiAgICAgICAgICBzY2FsZSA9IGl0ZW0uaW1hZ2VJbmZvLnNjYWxlLAogICAgICAgICAgc2NhbGVYID0gaXRlbS5zY2FsZVgsCiAgICAgICAgICBzY2FsZVkgPSBpdGVtLnNjYWxlWTsgLy8g5a+85Ye6Y2FudmFzCgogICAgICB2YXIgZXhwb3J0Q2FudmFzOwoKICAgICAgaWYgKCFleHBvcnRDYW52YXMpIHsKICAgICAgICBleHBvcnRDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICAgICAgICBleHBvcnRDYW52YXMuaWQgPSAiZXhwb3J0X2NhbnZhcyI7CiAgICAgICAgZXhwb3J0Q2FudmFzLnN0eWxlLmJvcmRlciA9ICIxcHggc29saWQgcGluayI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZXhwb3J0Q2FudmFzLmdldE9iamVjdHMoKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgZXhwb3J0Q2FudmFzLnJlbW92ZShjaGlsZCk7CiAgICAgICAgfSk7CiAgICAgIH0gLy8g6LCD5pW05a696auYCgoKICAgICAgdmFyIHdpZHRoID0gcm90YXRlICUgMTgwID09PSAwID8gc2NhbGUud2lkdGggOiBzY2FsZS5oZWlnaHQ7CiAgICAgIHZhciBoZWlnaHQgPSByb3RhdGUgJSAxODAgPT09IDAgPyBzY2FsZS5oZWlnaHQgOiBzY2FsZS53aWR0aDsKICAgICAgZXhwb3J0Q2FudmFzID0gbmV3IGZhYnJpYy5DYW52YXMoImV4cG9ydF9jYW52YXMiLCB7CiAgICAgICAgd2lkdGg6IHdpZHRoLAogICAgICAgIGhlaWdodDogaGVpZ2h0CiAgICAgIH0pOwogICAgICB2YXIgc3RhdGUgPSBpdGVtLmdldEN1cnJTdGF0ZSgpOyAvLyDnlLHkuo4wLjMzMzMzMzMg5a2Y5YKo54q25oCB5Lya5L+d5a2Y5Li6MC4zMyDlr7zlh7rlkI7mr5TkvovmnInnlaXlvq7kuI3lkIwg5omL5Yqo5L+d5oyB5LiA6Ie0CgogICAgICB2YXIgZml4U3RhdGUgPSBfdGhpcy5maXhTdGF0ZShzdGF0ZSwgewogICAgICAgIHNjYWxlWTogc2NhbGVZLAogICAgICAgIHNjYWxlWDogc2NhbGVYCiAgICAgIH0pOwoKICAgICAgZXhwb3J0Q2FudmFzLmxvYWRGcm9tSlNPTihmaXhTdGF0ZSwgZnVuY3Rpb24gKCkgewogICAgICAgIGV4cG9ydENhbnZhcy5kaXNjYXJkQWN0aXZlT2JqZWN0KCk7CiAgICAgICAgdmFyIHNlbCA9IG5ldyBmYWJyaWMuQWN0aXZlU2VsZWN0aW9uKGV4cG9ydENhbnZhcy5nZXRPYmplY3RzKCksIHsKICAgICAgICAgIGNhbnZhczogZXhwb3J0Q2FudmFzLAogICAgICAgICAgY29ybmVyU2l6ZTogMCwKICAgICAgICAgIGhhc0NvbnRyb2xzOiBmYWxzZQogICAgICAgIH0pOwogICAgICAgIGV4cG9ydENhbnZhcy5zZXRBY3RpdmVPYmplY3Qoc2VsKTsKICAgICAgICBzZWwudHJhbnNsYXRlWCA9ICJjZW50ZXIiOwogICAgICAgIHNlbC50cmFuc2xhdGVZID0gImNlbnRlciI7CiAgICAgICAgc2VsLmxlZnQgPSAwOwogICAgICAgIHNlbC50b3AgPSAwOyAvLyBleHBvcnRDYW52YXMuY2VudGVyT2JqZWN0KHNlbCk7CiAgICAgICAgLy8gZG9jdW1lbnQuYXBwZW5kQ2hpbGQoZXhwb3J0Q2FudmFzKTsKCiAgICAgICAgdmFyIGRhdGEgPSBleHBvcnRDYW52YXMudG9EYXRhVVJMKHsKICAgICAgICAgIC8vIG9yaWdpbi5oZWlnaHQgLyBzY2FsZS5oZWlnaHQsCiAgICAgICAgICAvLyBtdWx0aXBsaWVyOiAxMCwgLy8g5oGi5aSN5q+U5L6L5a+85Ye6CiAgICAgICAgICBmb3JtYXQ6ICJqcGVnIiwKICAgICAgICAgIHF1YWxpdHk6IDAuOCAvLyDpmY3otKjph48KCiAgICAgICAgfSk7CiAgICAgICAgZXhwb3J0Q2FudmFzLnJlbmRlckFsbCgpOwogICAgICAgIF90aGlzLmltZ1VybEV4cG9ydCA9IGRhdGE7CiAgICAgICAgcmVzbG92ZShkYXRhKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIGV4cG9ydEltYWdlOiBmdW5jdGlvbiBleHBvcnRJbWFnZSh0eXBlKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICB2YXIgaW5kZXggPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRoaXMuY3VyckluZGV4OwogICAgLy8gbGV0IGNlbnRlciA9IHRoaXMuY2FudmFzLmdldENlbnRlcigpOwogICAgLy8gbGV0IHpvb21Qb2ludCA9IG5ldyBmYWJyaWMuUG9pbnQoY2VudGVyLmxlZnQsIGNlbnRlci50b3ApOwogICAgLy8gdGhpcy5jYW52YXMuem9vbVRvUG9pbnQoem9vbVBvaW50LCAxKTsKICAgIC8vIHRoaXMuY2FudmFzLnJlbmRlckFsbCgpOwogICAgLy8g5a+85Ye65Y2V5bygKOm7mOiupOW9k+WJjSnmiJbmiYDmnIkKICAgIGlmICghdGhpcy5jdXJySXRlbSB8fCAhdHlwZSkgcmV0dXJuOwogICAgdGhpcy5zYXZlQ3Vyckl0ZW1TdGF0ZSgpOyAvLyDlr7zlh7rml7blgJnpu5jorqTkv53lrZjlvZPliY1pdGVt5LiA5qyh77yM6YG/5YWN54q25oCB6YGX5ryPCgogICAgaWYgKHR5cGUgPT09ICJzaW5nbGUiKSB7CiAgICAgIC8vIOWNleW8oAogICAgICBpZiAoaW5kZXggPCAwKSByZXR1cm47CiAgICAgIHJldHVybiB0aGlzLmV4cG9ydEltYWdlRnVuYyh0aGlzLml0ZW1MaXN0W2luZGV4XSk7CiAgICB9CgogICAgaWYgKHR5cGUgPT09ICJsaXN0IikgewogICAgICAvLyDlhajpg6gKICAgICAgcmV0dXJuIHRoaXMuaW1hZ2VMaXN0Lm1hcChmdW5jdGlvbiAoZCwgaSkgewogICAgICAgIGlmIChkLnJlbmRlcmVkKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLmV4cG9ydEltYWdlRnVuYyhfdGhpczIuaXRlbUxpc3RbaV0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc2xvdmUpIHsKICAgICAgICAgICAgcmV0dXJuIHJlc2xvdmUoZCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCiAgaW5pdERvY3VtZW50RXZlbnRzOiBmdW5jdGlvbiBpbml0RG9jdW1lbnRFdmVudHMoKSB7CiAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAvLyDngrnlh7voj5zljZXlpJbljLrln5/lsIblvLnlh7rlsYLmuIXpmaQKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjbWVudSIpOwoKICAgICAgaWYgKCFlLnRhcmdldC5pZCA9PT0gIm1lbnUiIHx8ICFtZW51LmNvbnRhaW5zKGUudGFyZ2V0KSkgewogICAgICAgIHZhciBwZW5jaWwgPSBfdGhpczMuJHJlZnMucGVuY2lsOwogICAgICAgIHBlbmNpbCAmJiBwZW5jaWwudW5TaG93KCk7CiAgICAgIH0KICAgIH0pOwogIH0sCiAgY2hhbmdlQ29uZmlnOiBmdW5jdGlvbiBjaGFuZ2VDb25maWcocHJvcCwgdmFsdWUpIHsKICAgIHRoaXMubXlDb25maWdbcHJvcF0gPSB2YWx1ZTsgLy8gY29uc29sZS5sb2coIiB0aGlzLm15Q29uZmlnLS0tLWNoYW5nZSIsIHRoaXMubXlDb25maWcpOwogIH0sCiAgZnJlZURyYXc6IGZ1bmN0aW9uIGZyZWVEcmF3KCkgewogICAgdmFyIGNhbnZhcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogdGhpcy5jYW52YXM7CiAgICB0aGlzLmNhbnZhcy5pc0RyYXdpbmdNb2RlID0gdHJ1ZTsKICAgIHZhciBoTGluZVBhdHRlcm5CcnVzaCA9IG5ldyBmYWJyaWMuUGF0dGVybkJydXNoKGNhbnZhcyk7CgogICAgaExpbmVQYXR0ZXJuQnJ1c2guZ2V0UGF0dGVyblNyYyA9IGZ1bmN0aW9uIChmYWJyaWMpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgcGF0dGVybkNhbnZhcyA9IGZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICAgICAgICBwYXR0ZXJuQ2FudmFzLndpZHRoID0gcGF0dGVybkNhbnZhcy5oZWlnaHQgPSAxMDsKICAgICAgICB2YXIgY3R4ID0gcGF0dGVybkNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICJncmVlbiI7CiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDEwOwogICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICBjdHgubW92ZVRvKDUsIDApOwogICAgICAgIGN0eC5saW5lVG8oNSwgMTApOwogICAgICAgIGN0eC5jbG9zZVBhdGgoKTsKICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgcmV0dXJuIHBhdHRlcm5DYW52YXM7CiAgICAgIH07CiAgICB9KGZhYnJpYyk7CgogICAgY2FudmFzLmZyZWVEcmF3aW5nQnJ1c2ggPSBoTGluZVBhdHRlcm5CcnVzaDsgLy8gY2FudmFzLmZyZWVEcmF3aW5nQnJ1c2gud2lkdGggPSAyMDsKICB9LAogIHN3aXRjaE1vZGU6IGZ1bmN0aW9uIHN3aXRjaE1vZGUobW9kZSkgewogICAgLy8gaWYgKHRoaXMubW9kZSA9PT0gbW9kZSkgewogICAgLy8gICB0aGlzLm1vZGUgPSAiIjsKICAgIC8vICAgcmV0dXJuOwogICAgLy8gfQogICAgdGhpcy5tb2RlID0gbW9kZTsgLy8gaWYgKHRoaXMubW9kZSA9PT0gbW9kZSkgcmV0dXJuOwoKICAgIGNvbnNvbGUubG9nKCJ0aGlzLm1vZGUiLCB0aGlzLm1vZGUpOwoKICAgIGlmIChtb2RlID09PSAidW5kbyIpIHsKICAgICAgdGhpcy51bmRvKCk7CiAgICB9CgogICAgaWYgKG1vZGUgPT09ICJwZW5jaWwiKSB7Ly8gdGhpcy5wcmVTYXZlKCk7CiAgICB9CiAgfSwKICB0ZXN0OiBmdW5jdGlvbiB0ZXN0KCkgewogICAgdGhpcy5mcmVlRHJhdyh0aGlzLmNhbnZhcyk7CiAgfSwKICBhZGRyZWN0OiBmdW5jdGlvbiBhZGRyZWN0KCkgewogICAgdmFyIHJlY3QgPSBuZXcgZmFicmljLlJlY3QoewogICAgICB0b3A6IDUwLAogICAgICAvL+i3neemu+eUu+W4g+S4iui+ueeahOi3neemuwogICAgICBsZWZ0OiAxMDAsCiAgICAgIC8v6Led56a755S75biD5bem5L6n55qE6Led56a777yM5Y2V5L2N5piv5YOP57SgCiAgICAgIHdpZHRoOiAxMDAsCiAgICAgIC8v55+p5b2i55qE5a695bqmCiAgICAgIGhlaWdodDogNzAsCiAgICAgIC8v55+p5b2i55qE6auY5bqmCiAgICAgIGZpbGw6ICJibHVlIiwKICAgICAgLy/loavlhYXnmoTpopzoibIKICAgICAgc3Ryb2tlOiAib3JhbmdlIiwKICAgICAgLy8g6L655qGG5Y6f6ImyCiAgICAgIHN0cm9rZVdpZHRoOiA1LAogICAgICAvLyDovrnmoYblpKflsI8KICAgICAgcng6IDgsCiAgICAgIC8v5ZyG6KeS5Y2K5b6ECiAgICAgIHJ5OiA0IC8v5ZyG6KeS5Y2K5b6ECgogICAgfSk7CiAgICB0aGlzLnJlY3QgPSByZWN0OwogICAgdGhpcy5jYW52YXMuYWRkKHJlY3QpOwogICAgdGhpcy5jYW52YXMucmVuZGVyQWxsKCk7CiAgfSwKICBkZWxyZWFjdDogZnVuY3Rpb24gZGVscmVhY3QoKSB7CiAgICB0aGlzLmNhbnZhcy5yZW1vdmUodGhpcy5yZWN0KTsKICAgIHRoaXMuY2FudmFzLnJlbmRlckFsbCgpOwogIH0sCiAgcHJldjogZnVuY3Rpb24gcHJldigpIHsKICAgIHRoaXMuY3VyckluZGV4IC09IDE7CiAgICB0aGlzLnN3aXRjaEltYWdlKHRoaXMuY3VyckluZGV4KTsKICB9LAogIG5leHQ6IGZ1bmN0aW9uIG5leHQoKSB7CiAgICB0aGlzLmN1cnJJbmRleCArPSAxOwogICAgdGhpcy5zd2l0Y2hJbWFnZSh0aGlzLmN1cnJJbmRleCk7CiAgfSwKICBzZXRDYW52YXNXSDogZnVuY3Rpb24gc2V0Q2FudmFzV0godywgaCkgewogICAgdGhpcy5jYW52YXMuc2V0V2lkdGgodyk7CiAgICB0aGlzLmNhbnZhcy5zZXRIZWlnaHQoaCk7CiAgfSwKICBpbml0Q2FudmFzRXZlbnRzOiBmdW5jdGlvbiBpbml0Q2FudmFzRXZlbnRzKCkgewogICAgdGhpcy5jYW52YXMub24oIm9iamVjdDphZGRlZCIsIHRoaXMuZGVhbEFkZCk7CiAgICB0aGlzLmNhbnZhcy5vbigib2JqZWN0Om1vZGlmaWVkIiwgdGhpcy5kZWFsTW9kaWZ5KTsKICAgIHRoaXMuY2FudmFzLm9uKCJvYmplY3Q6cmVtb3ZlZCIsIHRoaXMuZGVhbFJlbW92ZSk7IC8vIHRoaXMuY2FudmFzLm9uKCJtb3VzZTp3aGVlbCIsIHRoaXMubW91c2VXaGVlbCk7CgogICAgdGhpcy5jYW52YXMub24oInBhdGg6Y3JlYXRlZCIsIHRoaXMuZGVhbFBhdGhDcmVhdGVkKTsKICB9LAogIGRlYWxQYXRoQ3JlYXRlZDogZnVuY3Rpb24gZGVhbFBhdGhDcmVhdGVkKGUpIHsKICAgIC8vIGNvbnNvbGUubG9nKCJwYXRoLS0tLWNyZWF0ZWQiLCBlKTsKICAgIC8vIHRoaXMuY2FudmFzLnJlbW92ZShlLnBhdGgpOwogICAgLy8gdGhpcy5jYW52YXMucmVuZGVyQWxsKCk7CiAgICBpZiAoZS5wYXRoLmNsYXNzTmFtZSA9PT0gImN1c3RvbV9wYXRoIikgey8vCiAgICB9CgogICAgaWYgKHRoaXMubW9kZSA9PT0gImVyYXNlciIpIHsvLyBsZXQgb2JqcyA9IHRoaXMuY2FudmFzLmdldE9iamVjdHMoKTsKICAgICAgLy8gY29uc29sZS5sb2coIm9ianMiLCBvYmpzKTsKICAgICAgLy8gbGV0IHBhdGhzID0gW107CiAgICAgIC8vIGZvciAobGV0IGkgPSAwOyBpIDwgb2Jqcy5sZW5ndGg7IGkrKykgewogICAgICAvLyAgIGlmIChvYmpzW2ldLmdldCgidHlwZSIpID09PSAicGF0aCIgJiYgb2Jqc1tpXS5tb2RlVHlwZSA9PT0gImVyYXNlciIpIHsKICAgICAgLy8gICAgIC8vIHBhdGjnsbvlnosKICAgICAgLy8gICAgIHBhdGhzLnB1c2gob2Jqc1tpXSk7CiAgICAgIC8vICAgfQogICAgICAvLyB9CiAgICB9CgogICAgaWYgKHRoaXMubW9kZSA9PT0gInBlbmNpbCIpIHsvLyBjeHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gInNvdXJjZS1vdmVyIjsKICAgICAgLy8gZS5wYXRoLnNldCh7CiAgICAgIC8vICAgZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uOiAic291cmNlLW92ZXIiCiAgICAgIC8vIH0pOwogICAgICAvLyBlLnBhdGguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gInNvdXJjZS1vdmVyIjsKICAgICAgLy8gZS5wYXRoLnNlbGVjdGFibGUgPSBmYWxzZTsKICAgICAgLy8gZS5wYXRoLmV2ZW50ZWQgPSBmYWxzZTsKICAgICAgLy8gZS5wYXRoLmFic29sdXRlUG9zaXRpb25lZCA9IHRydWU7CiAgICB9IC8vIHRoaXMuY2FudmFzLnJlbmRlckFsbCgpOwoKICB9LAogIHRvTmV4dDogZnVuY3Rpb24gdG9OZXh0KCkgewogICAgdGhpcy5jdXJySW5kZXggKz0gMTsKICAgIHRoaXMuc3dpdGNoSW1hZ2UodGhpcy5jdXJySW5kZXgpOwogIH0sCiAgZGVhbEFkZDogZnVuY3Rpb24gZGVhbEFkZChlKSB7CiAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7IC8vIGNvbnNvbGUubG9nKCJkZWFsQWRkIiwgdGFyZ2V0KTsKCiAgICBpZiAodGFyZ2V0LmdldCgidHlwZSIpID09PSAicGF0aCIpIHsKICAgICAgaWYgKHRhcmdldC5jbGFzc05hbWUgIT09ICJjdXN0b21fcGF0aCIpIHsKICAgICAgICBjb25zb2xlLmxvZygiZGVhbEFkZCIsIHRhcmdldCwgdGFyZ2V0LmxlZnQpOyAvLyB0aGlzLmNhbnZhcy5yZW1vdmUoZS50YXJnZXQpOwogICAgICB9CiAgICB9IC8vIGNvbnNvbGUubG9nKCItLS0tZGVhbEFkZC0tLS0iLCBlKTsKCgogICAgaWYgKHRoaXMuaGlzdG9yeUNoYW5naW5nKSByZXR1cm47CiAgICBpZiAoZS50YXJnZXQuaXNCZykgcmV0dXJuOyAvLyBpZiAoIWUudGFyZ2V0LmlzQ29udGFpbmVkV2l0aGluT2JqZWN0KHRoaXMuY3Vyckl0ZW0uYmdJbWcpKSB7CiAgICAvLyAgIGUudGFyZ2V0LnNldCh7CiAgICAvLyAgICAgaGFzQm9yZGVyczogZmFsc2UsCiAgICAvLyAgICAgaGFzQ29udHJvbHM6IGZhbHNlLAogICAgLy8gICAgIHNlbGVjdGFibGU6IGZhbHNlCiAgICAvLyAgIH0pOwogICAgLy8gICB0aGlzLmNhbnZhcy5yZW1vdmUoZS50YXJnZXQpOwogICAgLy8gICBzZXRUaW1lb3V0KCgpID0+IGFsZXJ0KCLor7flnKjlm77niYfojIPlm7TlhoXmk43kvZwiKSwgNTAwKTsKICAgIC8vICAgcmV0dXJuOwogICAgLy8gfQogIH0sCiAgZGVhbE1vZGlmeTogZnVuY3Rpb24gZGVhbE1vZGlmeSgpIHsKICAgIGlmICh0aGlzLmhpc3RvcnlDaGFuZ2luZykgcmV0dXJuOyAvLyBjb25zb2xlLmxvZygiYWRkZWQiKTsKICB9LAogIGRlYWxSZW1vdmU6IGZ1bmN0aW9uIGRlYWxSZW1vdmUoKSB7CiAgICBpZiAodGhpcy5oaXN0b3J5Q2hhbmdpbmcpIHJldHVybjsgLy8gY29uc29sZS5sb2coInJlbW92ZWQiKTsKICB9LAogIGNsZWFyQm9hcmQ6IGZ1bmN0aW9uIGNsZWFyQm9hcmQoKSB7CiAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICB0aGlzLmNhbnZhcy5nZXRPYmplY3RzKCkuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHsKICAgICAgX3RoaXM0LmNhbnZhcy5yZW1vdmUoY2hpbGQpOwogICAgfSk7CiAgfSwKICBhZnRlclN3aXRjaDogZnVuY3Rpb24gYWZ0ZXJTd2l0Y2goaW5kZXgsIGl0ZW1PYmopIHsKICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgIHZhciBmaXJzdFJlbmRlciA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICB2YXIgaW1hZ2VJbmZvID0gaXRlbU9iai5pbWFnZUluZm8sCiAgICAgICAgc2NhbGVYID0gaXRlbU9iai5zY2FsZVgsCiAgICAgICAgc2NhbGVZID0gaXRlbU9iai5zY2FsZVk7CgogICAgaWYgKGZpcnN0UmVuZGVyKSB7CiAgICAgIHZhciBiZ0ltZyA9IG5ldyBmYWJyaWMuSW1hZ2UoKTsKICAgICAgYmdJbWcuc2V0U3JjKHRoaXMuaXRlbUxpc3RbaW5kZXhdLnVybCwgZnVuY3Rpb24gKCkgewogICAgICAgIGJnSW1nLmhhc0JvcmRlcnMgPSBmYWxzZTsKICAgICAgICBiZ0ltZy5oYXNDb250cm9scyA9IGZhbHNlOwogICAgICAgIGJnSW1nLnNlbGVjdGFibGUgPSBmYWxzZTsKICAgICAgICBiZ0ltZy5zY2FsZWFibGUgPSBmYWxzZTsgLy8gMC4zMzMzMyDkvJrlr7zoh7Tlr7zlh7rlm77niYfmnInnlZnnmb0gIOWmguaenOaUvuWkp+WImeS8muWvvOiHtOWbvueJh+WvvOWHuuS4jeWFqAoKICAgICAgICBiZ0ltZy5zY2FsZVggPSBzY2FsZVg7CiAgICAgICAgYmdJbWcuc2NhbGVZID0gc2NhbGVZOwogICAgICAgIGJnSW1nLnNjYWxlVG9IZWlnaHQoaW1hZ2VJbmZvLnNjYWxlLmhlaWdodCwgZmFsc2UpOwogICAgICAgIGJnSW1nLnNjYWxlVG9XaWR0aChpbWFnZUluZm8uc2NhbGUud2lkdGgsIGZhbHNlKTsKICAgICAgICBiZ0ltZy5jcm9zc09yaWdpbiA9ICJhbm9ueW1vdXMiOwogICAgICAgIGJnSW1nLnRyYW5zbGF0ZVggPSAidG9wIjsKICAgICAgICBiZ0ltZy50cmFuc2xhdGVZID0gImxlZnQiOyAvLyBiZ0ltZy5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAiZGVzdGluYXRpb24tb3ZlciI7CgogICAgICAgIGJnSW1nLmxlZnQgPSAwOwogICAgICAgIGJnSW1nLnRvcCA9IDA7CiAgICAgICAgYmdJbWcuekluZGV4ID0gMTsKICAgICAgICBiZ0ltZy5pc0JnID0gdHJ1ZTsgLy8g5Yqo5oCB5re75Yqgc2NhbGXmr5TkvosKCiAgICAgICAgX3RoaXM1LmNsZWFyQm9hcmQoKTsKCiAgICAgICAgX3RoaXM1LnNldENhbnZhc1dIKGltYWdlSW5mby5zY2FsZS53aWR0aCwgaW1hZ2VJbmZvLnNjYWxlLmhlaWdodCk7IC8vIOWIneasoeWKoOi9veeahEltYWdl77yM6ZyA6KaB6Ieq5Yqo5Yib5bu65LiA5p2h5Y6G5Y+y6K6w5b2VCgoKICAgICAgICBiZ0ltZy5zZW5kVG9CYWNrKCk7CiAgICAgICAgX3RoaXM1LmN1cnJJdGVtLmJnSW1nID0gYmdJbWc7CgogICAgICAgIF90aGlzNS5jYW52YXMuYWRkKGJnSW1nKTsKCiAgICAgICAgX3RoaXM1LnNhdmVDdXJySXRlbVN0YXRlKCk7CgogICAgICAgIF90aGlzNS5jYW52YXMucmVuZGVyQWxsKCk7CgogICAgICAgIF90aGlzNS5oaXN0b3J5Q2hhbmdpbmcgPSBmYWxzZTsKICAgICAgICBfdGhpczUuc3dpdGNoaW5nID0gZmFsc2U7CiAgICAgIH0sIC8vIOmYsuatoueUu+W4g+axoeafkwogICAgICB7CiAgICAgICAgY3Jvc3NPcmlnaW46ICJhbm9ueW1vdXMiCiAgICAgIH0pOwogICAgfSBlbHNlIHsvLyDpnZ7pppbmrKHliqDovb0KICAgIH0KICB9LAogIHN3aXRjaEltYWdlOiBmdW5jdGlvbiBzd2l0Y2hJbWFnZShpbmRleCkgewogICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgaWYgKHRoaXMuY3VyckluZGV4IDwgMCkgcmV0dXJuOwogICAgdmFyIG9iaiA9IHRoaXMuaW1hZ2VMaXN0W2luZGV4XTsKICAgIGlmICghb2JqKSByZXR1cm47CiAgICB2YXIgaXRlbU9iajsKCiAgICBpZiAob2JqICYmICFvYmoucmVuZGVyZWQpIHsKICAgICAgY29uc29sZS5sb2coIummluasoea4suafkyIpOyAvLyDpppbmrKHmuLLmn5MKCiAgICAgIGl0ZW1PYmogPSBuZXcgSXRlbSh7CiAgICAgICAgdXJsOiB0aGlzLmltYWdlTGlzdFtpbmRleF0udXJsLAogICAgICAgIC8vIGNhbnZhczogdGhpcy5jYW52YXMKICAgICAgICBjb25XSDogdGhpcy5jb25XSAogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNi5hZnRlclN3aXRjaChpbmRleCwgaXRlbU9iaiwgdHJ1ZSk7CiAgICAgIH0pOwogICAgICB0aGlzLmN1cnJJdGVtID0gaXRlbU9iajsKICAgICAgdGhpcy5pdGVtTGlzdFt0aGlzLmN1cnJJbmRleF0gPSBpdGVtT2JqOwogICAgICB0aGlzLmltYWdlTGlzdFt0aGlzLmN1cnJJbmRleF0ucmVuZGVyZWQgPSB0cnVlOwogICAgfSBlbHNlIGlmIChvYmogJiYgb2JqLnJlbmRlcmVkKSB7CiAgICAgIC8vIOmdnummluasoea4suafkwogICAgICBjb25zb2xlLmxvZygi6Z2e6aaW5qyh5riy5p+TIik7CiAgICAgIHZhciBzdGF0ZSA9IGl0ZW1PYmouZ2V0Q3VyclN0YXRlKCk7CiAgICAgIHRoaXMuY2FudmFzLmxvYWRGcm9tSlNPTihzdGF0ZSwgZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNi5hZnRlclN3aXRjaChpbmRleCwgaXRlbU9iaiwgZmFsc2UpOyAvLyB0aGlzLmJnSW1nID0gdGhpcy5jYW52YXMuZ2V0T2JqZWN0cygpWzBdOwogICAgICAgIC8vIHRoaXMuYmdJbWcucm90YXRlKGl0ZW1PYmoucm90YXRlKTsKICAgICAgICAvLyB0aGlzLmlzQ29ycmVjdGlvbldvcmtWZXJzaW9uICYmIHRoaXMuY2hhbmdlWm9vbShpdGVtT2JqLnpvb20pOwogICAgICAgIC8vIGFmdGVyU3dpdGNoKGZhbHNlKTsKCiAgICAgIH0pOwogICAgfQogIH0sCiAgc2F2ZUN1cnJJdGVtU3RhdGU6IGZ1bmN0aW9uIHNhdmVDdXJySXRlbVN0YXRlKCkgewogICAgY29uc29sZS5jb3VudCgiPT09PT09PXNhdmVDdXJySXRlbVN0YXRlPT09PT09PSIpOyAvLyDkv53lrZjlvZPliY3mr4/kuKrlrp7kvovnirbmgIEKCiAgICBpZiAoIXRoaXMuY3Vyckl0ZW0pIHJldHVybjsKICAgIHZhciBpbWdEYXRhID0gdGhpcy5jYW52YXMudG9EYXRhVVJMKCk7CiAgICB0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKTsKICAgIHRoaXMuY3Vyckl0ZW0uc2F2ZShpbWdEYXRhLCB0aGlzLmNhbnZhcy50b0pTT04oWyJ3aWR0aCIsICJoZWlnaHQiLCAiem9vbSJdKSk7CiAgICB0aGlzLmltZ1VybCA9IGltZ0RhdGE7CiAgfSwKICB1bmRvOiBmdW5jdGlvbiB1bmRvKCkgewogICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgaWYgKCF0aGlzLmN1cnJJdGVtIHx8IHRoaXMuaGlzdG9yeUNoYW5naW5nKSByZXR1cm47CiAgICB2YXIgaGlzdG9yeSA9IHRoaXMuY3Vyckl0ZW0uZ2V0UHJlSGlzdG9yeSgpOwogICAgdmFyIF90aGlzJGN1cnJJdGVtID0gdGhpcy5jdXJySXRlbSwKICAgICAgICBzY2FsZVkgPSBfdGhpcyRjdXJySXRlbS5zY2FsZVksCiAgICAgICAgc2NhbGVYID0gX3RoaXMkY3Vyckl0ZW0uc2NhbGVYOwogICAgdmFyIGZpeEhpc3RvcnkgPSB0aGlzLmZpeFN0YXRlKGhpc3RvcnksIHsKICAgICAgc2NhbGVYOiBzY2FsZVgsCiAgICAgIHNjYWxlWTogc2NhbGVZCiAgICB9KTsKCiAgICBpZiAoZml4SGlzdG9yeSkgewogICAgICB2YXIgaGlzdG9yeU9iaiA9IEpTT04ucGFyc2UoZml4SGlzdG9yeSk7CiAgICAgIHZhciB3aWR0aCA9IGhpc3RvcnlPYmoud2lkdGgsCiAgICAgICAgICBoZWlnaHQgPSBoaXN0b3J5T2JqLmhlaWdodDsKICAgICAgdGhpcy5jYW52YXMubG9hZEZyb21KU09OKGZpeEhpc3RvcnksIGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAod2lkdGggJiYgaGVpZ2h0KSB7CiAgICAgICAgICBfdGhpczcuc2V0Q2FudmFzV0god2lkdGgsIGhlaWdodCk7CiAgICAgICAgfQoKICAgICAgICBfdGhpczcuaGlzdG9yeUNoYW5naW5nID0gZmFsc2U7CgogICAgICAgIF90aGlzNy5jYW52YXMucmVuZGVyQWxsKCk7CiAgICAgIH0pOwogICAgfQogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAvLyDpnZnnlKjnvJPlrZgg6K+l5bGe5oCn5Lya5a+5bGluZSBob3ZlcuS6i+S7tuS6p+eUn+W9seWTjSDpq5jkuq7kuI3nlJ/mlYgKICAgIGZhYnJpYy5PYmplY3QucHJvdG90eXBlLm9iamVjdENhY2hpbmcgPSBmYWxzZTsKICAgIHZhciBjYW52YXMgPSBuZXcgZmFicmljLkNhbnZhcygiaW1hZ2VfY2FudmFzIiwgewogICAgICBiYWNrZ3JvdW5kQ29sb3I6ICIjZmZmIiAvLyBzZWxlY3Rpb246IGZhbHNlCiAgICAgIC8vIGlzRHJhd2luZ01vZGU6IHRydWUKCiAgICB9KTsgLy8g5a6e546wbW91c2VvdmVy5LqL5Lu2CgogICAgY2FudmFzLmZpbmRUYXJnZXQgPSBmdW5jdGlvbiAob3JpZ2luYWxGbikgewogICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciB0YXJnZXQgPSBvcmlnaW5hbEZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgogICAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICAgIGlmICh0aGlzLl9ob3ZlcmVkVGFyZ2V0ICE9PSB0YXJnZXQpIHsKICAgICAgICAgICAgY2FudmFzLmZpcmUoIm9iamVjdDpvdmVyIiwgewogICAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKHRoaXMuX2hvdmVyZWRUYXJnZXQpIHsKICAgICAgICAgICAgICBjYW52YXMuZmlyZSgib2JqZWN0Om91dCIsIHsKICAgICAgICAgICAgICAgIHRhcmdldDogdGhpcy5faG92ZXJlZFRhcmdldAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLl9ob3ZlcmVkVGFyZ2V0ID0gdGFyZ2V0OwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5faG92ZXJlZFRhcmdldCkgewogICAgICAgICAgY2FudmFzLmZpcmUoIm9iamVjdDpvdXQiLCB7CiAgICAgICAgICAgIHRhcmdldDogdGhpcy5faG92ZXJlZFRhcmdldAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLl9ob3ZlcmVkVGFyZ2V0ID0gbnVsbDsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0YXJnZXQ7CiAgICAgIH07CiAgICB9KGNhbnZhcy5maW5kVGFyZ2V0KTsKCiAgICB0aGlzLmNhbnZhcyA9IGNhbnZhczsKICAgIHRoaXMuaW5pdENhbnZhc0V2ZW50cygpOwogICAgdGhpcy5pbml0RG9jdW1lbnRFdmVudHMoKTsgLy8gdGhpcy5mcmVlRHJhdyhjYW52YXMpOwoKICAgIHRoaXMuaW1hZ2VMaXN0ID0gdGhpcy5pbWFnZUxpc3QubWFwKGZ1bmN0aW9uIChkKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdXJsOiBkLAogICAgICAgIHJlbmRlcmVkOiBmYWxzZQogICAgICB9OwogICAgfSk7CiAgICB2YXIgY29udGFpbmVyRE9NOwogICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICBjb250YWluZXJET00gPSBfdGhpczguJHJlZnMuaW1hZ2VfY2FudmFzX3dyYXA7CiAgICAgIF90aGlzOC5jb25XSCA9IHsKICAgICAgICB3aWR0aDogY29udGFpbmVyRE9NLmNsaWVudFdpZHRoLAogICAgICAgIGhlaWdodDogY29udGFpbmVyRE9NLmNsaWVudEhlaWdodAogICAgICB9OwoKICAgICAgX3RoaXM4LnRvTmV4dCgpOyAvLyB0aGlzLmFkZHJlY3QoKTsKCiAgICB9KTsKICB9LAogIG1ldGhvZHM6IG1ldGhvZHMsCiAgcHJvcHM6IHsKICAgIGNvbmZpZzogewogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdCgpIHt9LAogICAgICB0eXBlOiBPYmplY3QKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICB2YXIgZGVmYXVsdENvbmZpZyA9IHsKICAgICAgY29sb3JMaXN0OiBbIiNiOTJiMjciLCAiI2VlOWNhNyIsICIjMTU2NUMwIiwgIiNhOGZmNzgiXSwKICAgICAgY29sb3I6ICIjYjkyYjI3IiwKICAgICAgcGVuY2lsU2l6ZUxpc3Q6IFsxLCAyLCAzLCA0XSwKICAgICAgcGVuY2lsU2l6ZTogMSwKICAgICAgcm90YXRlTGVmdDogdHJ1ZSwKICAgICAgcm90YXRlUmlnaHQ6IHRydWUsCiAgICAgIHpvb21JbjogdHJ1ZSwKICAgICAgem9vbU91dDogdHJ1ZSwKICAgICAgcHJldjogdHJ1ZSwKICAgICAgbmV4dDogdHJ1ZQogICAgfTsKICAgIHJldHVybiB7CiAgICAgIGNhbnZhczogbnVsbCwKICAgICAgY29uV0g6IHt9LAogICAgICBoaXN0b3J5Q2hhbmdpbmc6IGZhbHNlLAogICAgICBpbWFnZUxpc3Q6IGltYWdlTGlzdCwKICAgICAgaXRlbUxpc3Q6IFtdLAogICAgICBjdXJySW5kZXg6IC0xLAogICAgICBjdXJySXRlbTogbnVsbCwKICAgICAgcGFubmluZzogZmFsc2UsCiAgICAgIG1vZGU6ICIiLAogICAgICBmcmVlRHJhd2luZ0JydXNoV2lkdGg6IDIwLAogICAgICBteUNvbmZpZzogT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdENvbmZpZywgdGhpcy5jb25maWcpLAogICAgICBpbWdVcmw6IG51bGwsCiAgICAgIGltZ1VybEV4cG9ydDogbnVsbCAvLyBjb2xvcnM6IHt9CiAgICAgIC8vIHN0YXR1c0xpc3Q6IG51bGwsCgogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIE1lbnVEcmFnOiBNZW51RHJhZywKICAgIE1lbnVQZW5jaWw6IE1lbnVQZW5jaWwsCiAgICBNZW51Wm9vbTogTWVudVpvb20sCiAgICBNZW51UmVzdG9yZTogTWVudVJlc3RvcmUsCiAgICBNZW51Um90YXRlOiBNZW51Um90YXRlLAogICAgTWVudUNvbG9yOiBNZW51Q29sb3IsCiAgICBNZW51RXJhc2VyOiBNZW51RXJhc2VyLAogICAgTWVudVN3aXRjaEltYWdlOiBNZW51U3dpdGNoSW1hZ2UsCiAgICBNZW51RG93bmxvYWQ6IE1lbnVEb3dubG9hZCwKICAgIE1lbnVVbmRvOiBNZW51VW5kbwogIH0KfTs="},{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div id=\"container\">\n      <div id=\"image_canvas_wrap\" ref=\"image_canvas_wrap\">\n        <canvas id=\"image_canvas\" ref=\"image_canvas\"></canvas>\n      </div>\n      <div id=\"menu\">\n        <menu-switch-image\n          @prevFunc=\"prev\"\n          @nextFunc=\"next\"\n          :prev=\"myConfig && myConfig.prev\"\n          :next=\"myConfig && myConfig.next\"\n          class=\"menu_item\"\n        >\n        </menu-switch-image>\n\n        <menu-undo\n          :mode=\"mode\"\n          :canvas=\"canvas\"\n          @click=\"switchMode('undo')\"\n          class=\"menu_item\"\n        ></menu-undo>\n\n        <menu-drag\n          :mode=\"mode\"\n          :canvas=\"canvas\"\n          @click=\"switchMode('drag')\"\n          class=\"menu_item\"\n        />\n        <menu-pencil\n          :mode=\"mode\"\n          :canvas=\"canvas\"\n          @click=\"switchMode('pencil')\"\n          :color=\"myConfig && myConfig.color\"\n          :pencilSizeList=\"myConfig && myConfig.pencilSizeList\"\n          :pencilSize=\"myConfig && myConfig.pencilSize\"\n          @changeConfig=\"changeConfig\"\n          ref=\"pencil\"\n          class=\"menu_item\"\n        />\n\n        <menu-eraser\n          :canvas=\"canvas\"\n          :mode=\"mode\"\n          @click=\"switchMode('eraser')\"\n          class=\"menu_item\"\n        />\n        <menu-color\n          @click=\"switchMode\"\n          class=\"menu_item\"\n          :colorList=\"myConfig && myConfig.colorList\"\n          :mode=\"mode\"\n          @changeConfig=\"changeConfig\"\n        >\n        </menu-color>\n\n        <menu-rotate\n          class=\"menu_item\"\n          :canvas=\"canvas\"\n          :currItem=\"currItem\"\n          :rotateRight=\"myConfig && myConfig.rotateRight\"\n          :rotateLeft=\"myConfig && myConfig.rotateLeft\"\n        />\n\n        <menu-zoom\n          class=\"menu_item\"\n          :canvas=\"canvas\"\n          :zoomIn=\"myConfig && myConfig.zoomIn\"\n          :zoomOut=\"myConfig && myConfig.zoomOut\"\n        />\n\n        <menu-restore\n          :canvas=\"canvas\"\n          :bg=\"currItem && currItem.bgImg\"\n          :currItem=\"currItem\"\n          class=\"menu_item\"\n        ></menu-restore>\n\n        <menu-download\n          :canvas=\"canvas\"\n          class=\"menu_item\"\n          :exportImage=\"exportImage\"\n        >\n        </menu-download>\n\n        <button @click=\"saveCurrItemState\">点我保存状态</button>\n\n        <!-- <button @click=\"exportTest\">点我导出</button> -->\n      </div>\n    </div>\n\n    <img :src=\"imgUrl\" style=\"border: 1px solid blue\" />\n    <img :src=\"imgUrlExport\" style=\"border: 1px solid green\" />\n  </div>\n</template>\n\n<script>\nimport { fabric } from \"fabric\";\nimport _ from \"lodash\";\nimport { imageList } from \"./util.js\";\nimport Item from \"./Item\";\nimport MenuDrag from \"./menu/drag.vue\";\nimport MenuPencil from \"./menu/pencil.vue\";\nimport MenuZoom from \"./menu/zoom.vue\";\nimport MenuRestore from \"./menu/restore.vue\";\nimport MenuRotate from \"./menu/rotate.vue\";\nimport MenuColor from \"./menu/color.vue\";\nimport MenuEraser from \"./menu/eraser.vue\";\nimport MenuSwitchImage from \"./menu/switchImage.vue\";\nimport MenuDownload from \"./menu/download.vue\";\nimport MenuUndo from \"./menu/undo.vue\";\n// fabric.Object.prototype.set({\n//   borderColor: \"red\",\n//   cornerColor: \"red\", //激活状态角落图标的填充颜色\n//   cornerStrokeColor: \"\", //激活状态角落图标的边框颜色\n//   borderOpacityWhenMoving: 1,\n//   borderScaleFactor: 1,\n//   cornerSize: 8,\n//   cornerStyle: \"rect\", //rect,circle\n//   centeredScaling: false, //角落放大缩小是否是以图形中心为放大原点\n//   centeredRotation: true, //旋转按钮旋转是否是左上角为圆心旋转\n//   transparentCorners: false, //激活状态角落的图标是否透明\n//   rotatingPointOffset: 20, //旋转距旋转体的距离\n//   originX: \"center\",\n//   originY: \"center\",\n//   lockUniScaling: false, //只显示四角的操作\n//   hasRotatingPoint: true, //是否显示旋转按钮\n//   selectionDashArray: [5, 5]\n// });\nconst methods = {\n  // 延迟存储\n\n  preSave: _.debounce(function() {\n    this.saveCurrItemState();\n  }, 4000),\n  // 调整快照状态\n  fixState(state, { scaleX, scaleY }) {\n    if (!state) {\n      console.error(\"state is required\");\n      return false;\n    }\n    let stateObj = JSON.parse(state);\n    stateObj.objects[0].scaleY = scaleY;\n    stateObj.objects[0].scaleX = scaleX;\n    return JSON.stringify(stateObj);\n  },\n  // 导出图片的方法\n  exportImageFunc(item) {\n    return new Promise((reslove, reject) => {\n      if (!item) reject(\"item is required, item:\", item);\n      // this.saveCurrItemState(); // 导出时候默认保存一次，避免状态遗漏\n      const {\n        rotate,\n        imageInfo: { scale },\n        scaleX,\n        scaleY\n      } = item;\n      // 导出canvas\n      let exportCanvas;\n      if (!exportCanvas) {\n        exportCanvas = document.createElement(\"canvas\");\n        exportCanvas.id = \"export_canvas\";\n        exportCanvas.style.border = \"1px solid pink\";\n      } else {\n        exportCanvas.getObjects().forEach((child) => {\n          exportCanvas.remove(child);\n        });\n      }\n      // 调整宽高\n      const width = rotate % 180 === 0 ? scale.width : scale.height;\n      const height = rotate % 180 === 0 ? scale.height : scale.width;\n      exportCanvas = new fabric.Canvas(\"export_canvas\", {\n        width,\n        height\n      });\n\n      let state = item.getCurrState();\n      // 由于0.3333333 存储状态会保存为0.33 导出后比例有略微不同 手动保持一致\n      let fixState = this.fixState(state, { scaleY, scaleX });\n      exportCanvas.loadFromJSON(fixState, () => {\n        exportCanvas.discardActiveObject();\n        let sel = new fabric.ActiveSelection(exportCanvas.getObjects(), {\n          canvas: exportCanvas,\n          cornerSize: 0,\n          hasControls: false\n        });\n        exportCanvas.setActiveObject(sel);\n        sel.translateX = \"center\";\n        sel.translateY = \"center\";\n        sel.left = 0;\n        sel.top = 0;\n\n        // exportCanvas.centerObject(sel);\n        // document.appendChild(exportCanvas);\n\n        let data = exportCanvas.toDataURL({\n          // origin.height / scale.height,\n          // multiplier: 10, // 恢复比例导出\n          format: \"jpeg\",\n          quality: 0.8 // 降质量\n        });\n        exportCanvas.renderAll();\n        this.imgUrlExport = data;\n\n        reslove(data);\n      });\n    });\n  },\n  exportImage(type, index = this.currIndex) {\n    // let center = this.canvas.getCenter();\n    // let zoomPoint = new fabric.Point(center.left, center.top);\n    // this.canvas.zoomToPoint(zoomPoint, 1);\n    // this.canvas.renderAll();\n    // 导出单张(默认当前)或所有\n    if (!this.currItem || !type) return;\n    this.saveCurrItemState(); // 导出时候默认保存当前item一次，避免状态遗漏\n    if (type === \"single\") {\n      // 单张\n      if (index < 0) return;\n      return this.exportImageFunc(this.itemList[index]);\n    }\n    if (type === \"list\") {\n      // 全部\n      return this.imageList.map((d, i) => {\n        if (d.rendered) {\n          return this.exportImageFunc(this.itemList[i]);\n        } else {\n          return new Promise((reslove) => reslove(d));\n        }\n      });\n    }\n  },\n  initDocumentEvents() {\n    // 点击菜单外区域将弹出层清除\n    document.addEventListener(\"click\", (e) => {\n      let menu = document.querySelector(\"#menu\");\n      if (!e.target.id === \"menu\" || !menu.contains(e.target)) {\n        let pencil = this.$refs.pencil;\n        pencil && pencil.unShow();\n      }\n    });\n  },\n  changeConfig(prop, value) {\n    this.myConfig[prop] = value;\n    // console.log(\" this.myConfig----change\", this.myConfig);\n  },\n  freeDraw(canvas = this.canvas) {\n    this.canvas.isDrawingMode = true;\n    var hLinePatternBrush = new fabric.PatternBrush(canvas);\n    hLinePatternBrush.getPatternSrc = (function(fabric) {\n      return function() {\n        var patternCanvas = fabric.document.createElement(\"canvas\");\n        patternCanvas.width = patternCanvas.height = 10;\n        var ctx = patternCanvas.getContext(\"2d\");\n        ctx.strokeStyle = \"green\";\n        ctx.lineWidth = 10;\n        ctx.beginPath();\n        ctx.moveTo(5, 0);\n        ctx.lineTo(5, 10);\n        ctx.closePath();\n        ctx.stroke();\n        return patternCanvas;\n      };\n    })(fabric);\n\n    canvas.freeDrawingBrush = hLinePatternBrush;\n    // canvas.freeDrawingBrush.width = 20;\n  },\n  switchMode(mode) {\n    // if (this.mode === mode) {\n    //   this.mode = \"\";\n    //   return;\n    // }\n    this.mode = mode;\n    // if (this.mode === mode) return;\n    console.log(\"this.mode\", this.mode);\n\n    if (mode === \"undo\") {\n      this.undo();\n    }\n\n    if (mode === \"pencil\") {\n      // this.preSave();\n    }\n  },\n  test() {\n    this.freeDraw(this.canvas);\n  },\n  addrect() {\n    var rect = new fabric.Rect({\n      top: 50, //距离画布上边的距离\n      left: 100, //距离画布左侧的距离，单位是像素\n      width: 100, //矩形的宽度\n      height: 70, //矩形的高度\n      fill: \"blue\", //填充的颜色\n      stroke: \"orange\", // 边框原色\n      strokeWidth: 5, // 边框大小\n      rx: 8, //圆角半径\n      ry: 4 //圆角半径\n    });\n    this.rect = rect;\n\n    this.canvas.add(rect);\n    this.canvas.renderAll();\n  },\n  delreact() {\n    this.canvas.remove(this.rect);\n    this.canvas.renderAll();\n  },\n  prev() {\n    this.currIndex -= 1;\n    this.switchImage(this.currIndex);\n  },\n  next() {\n    this.currIndex += 1;\n    this.switchImage(this.currIndex);\n  },\n  setCanvasWH(w, h) {\n    this.canvas.setWidth(w);\n    this.canvas.setHeight(h);\n  },\n  initCanvasEvents() {\n    this.canvas.on(\"object:added\", this.dealAdd);\n    this.canvas.on(\"object:modified\", this.dealModify);\n    this.canvas.on(\"object:removed\", this.dealRemove);\n\n    // this.canvas.on(\"mouse:wheel\", this.mouseWheel);\n    this.canvas.on(\"path:created\", this.dealPathCreated);\n  },\n  dealPathCreated(e) {\n    // console.log(\"path----created\", e);\n    // this.canvas.remove(e.path);\n    // this.canvas.renderAll();\n\n    if (e.path.className === \"custom_path\") {\n      //\n    }\n    if (this.mode === \"eraser\") {\n      // let objs = this.canvas.getObjects();\n      // console.log(\"objs\", objs);\n      // let paths = [];\n      // for (let i = 0; i < objs.length; i++) {\n      //   if (objs[i].get(\"type\") === \"path\" && objs[i].modeType === \"eraser\") {\n      //     // path类型\n      //     paths.push(objs[i]);\n      //   }\n      // }\n    }\n\n    if (this.mode === \"pencil\") {\n      // cxt.globalCompositeOperation = \"source-over\";\n      // e.path.set({\n      //   globalCompositeOperation: \"source-over\"\n      // });\n      // e.path.globalCompositeOperation = \"source-over\";\n      // e.path.selectable = false;\n      // e.path.evented = false;\n      // e.path.absolutePositioned = true;\n    }\n\n    // this.canvas.renderAll();\n  },\n  toNext() {\n    this.currIndex += 1;\n    this.switchImage(this.currIndex);\n  },\n  dealAdd(e) {\n    let target = e.target;\n    // console.log(\"dealAdd\", target);\n    if (target.get(\"type\") === \"path\") {\n      if (target.className !== \"custom_path\") {\n        console.log(\"dealAdd\", target, target.left);\n        // this.canvas.remove(e.target);\n      }\n    }\n    // console.log(\"----dealAdd----\", e);\n    if (this.historyChanging) return;\n    if (e.target.isBg) return;\n    // if (!e.target.isContainedWithinObject(this.currItem.bgImg)) {\n    //   e.target.set({\n    //     hasBorders: false,\n    //     hasControls: false,\n    //     selectable: false\n    //   });\n    //   this.canvas.remove(e.target);\n    //   setTimeout(() => alert(\"请在图片范围内操作\"), 500);\n    //   return;\n    // }\n  },\n  dealModify() {\n    if (this.historyChanging) return;\n    // console.log(\"added\");\n  },\n  dealRemove() {\n    if (this.historyChanging) return;\n    // console.log(\"removed\");\n  },\n  clearBoard() {\n    this.canvas.getObjects().forEach((child) => {\n      this.canvas.remove(child);\n    });\n  },\n\n  afterSwitch(index, itemObj, firstRender = false) {\n    const { imageInfo, scaleX, scaleY } = itemObj;\n    if (firstRender) {\n      let bgImg = new fabric.Image();\n      bgImg.setSrc(\n        this.itemList[index].url,\n        () => {\n          bgImg.hasBorders = false;\n          bgImg.hasControls = false;\n          bgImg.selectable = false;\n          bgImg.scaleable = false;\n          // 0.33333 会导致导出图片有留白  如果放大则会导致图片导出不全\n          bgImg.scaleX = scaleX;\n          bgImg.scaleY = scaleY;\n          bgImg.scaleToHeight(imageInfo.scale.height, false);\n          bgImg.scaleToWidth(imageInfo.scale.width, false);\n          bgImg.crossOrigin = \"anonymous\";\n          bgImg.translateX = \"top\";\n          bgImg.translateY = \"left\";\n          // bgImg.globalCompositeOperation = \"destination-over\";\n          bgImg.left = 0;\n          bgImg.top = 0;\n          bgImg.zIndex = 1;\n          bgImg.isBg = true;\n          // 动态添加scale比例\n\n          this.clearBoard();\n          this.setCanvasWH(imageInfo.scale.width, imageInfo.scale.height);\n          // 初次加载的Image，需要自动创建一条历史记录\n          bgImg.sendToBack();\n          this.currItem.bgImg = bgImg;\n\n          this.canvas.add(bgImg);\n          this.saveCurrItemState();\n\n          this.canvas.renderAll();\n          this.historyChanging = false;\n          this.switching = false;\n        },\n        // 防止画布污染\n        { crossOrigin: \"anonymous\" }\n      );\n    } else {\n      // 非首次加载\n    }\n  },\n  switchImage(index) {\n    if (this.currIndex < 0) return;\n    let obj = this.imageList[index];\n    if (!obj) return;\n    let itemObj;\n    if (obj && !obj.rendered) {\n      console.log(\"首次渲染\");\n      // 首次渲染\n      itemObj = new Item(\n        {\n          url: this.imageList[index].url,\n          // canvas: this.canvas\n          conWH: this.conWH\n        },\n        () => this.afterSwitch(index, itemObj, true)\n      );\n      this.currItem = itemObj;\n      this.itemList[this.currIndex] = itemObj;\n      this.imageList[this.currIndex].rendered = true;\n    } else if (obj && obj.rendered) {\n      // 非首次渲染\n      console.log(\"非首次渲染\");\n      let state = itemObj.getCurrState();\n      this.canvas.loadFromJSON(state, () => {\n        this.afterSwitch(index, itemObj, false);\n        // this.bgImg = this.canvas.getObjects()[0];\n        // this.bgImg.rotate(itemObj.rotate);\n        // this.isCorrectionWorkVersion && this.changeZoom(itemObj.zoom);\n        // afterSwitch(false);\n      });\n    }\n  },\n  saveCurrItemState() {\n    console.count(\"=======saveCurrItemState=======\");\n    // 保存当前每个实例状态\n    if (!this.currItem) return;\n    let imgData = this.canvas.toDataURL();\n    this.canvas.renderAll();\n    this.currItem.save(\n      imgData,\n      this.canvas.toJSON([\"width\", \"height\", \"zoom\"])\n    );\n    this.imgUrl = imgData;\n  },\n  undo() {\n    if (!this.currItem || this.historyChanging) return;\n    let history = this.currItem.getPreHistory();\n    const { scaleY, scaleX } = this.currItem;\n    let fixHistory = this.fixState(history, { scaleX, scaleY });\n    if (fixHistory) {\n      const historyObj = JSON.parse(fixHistory);\n      const { width, height } = historyObj;\n      this.canvas.loadFromJSON(fixHistory, () => {\n        if (width && height) {\n          this.setCanvasWH(width, height);\n        }\n        this.historyChanging = false;\n        this.canvas.renderAll();\n      });\n    }\n  }\n};\nexport default {\n  mounted() {\n    // 静用缓存 该属性会对line hover事件产生影响 高亮不生效\n    fabric.Object.prototype.objectCaching = false;\n    let canvas = new fabric.Canvas(\"image_canvas\", {\n      backgroundColor: \"#fff\"\n      // selection: false\n      // isDrawingMode: true\n    });\n\n    // 实现mouseover事件\n    canvas.findTarget = (function(originalFn) {\n      return function() {\n        let target = originalFn.apply(this, arguments);\n        if (target) {\n          if (this._hoveredTarget !== target) {\n            canvas.fire(\"object:over\", { target: target });\n            if (this._hoveredTarget) {\n              canvas.fire(\"object:out\", { target: this._hoveredTarget });\n            }\n            this._hoveredTarget = target;\n          }\n        } else if (this._hoveredTarget) {\n          canvas.fire(\"object:out\", { target: this._hoveredTarget });\n          this._hoveredTarget = null;\n        }\n        return target;\n      };\n    })(canvas.findTarget);\n\n    this.canvas = canvas;\n\n    this.initCanvasEvents();\n\n    this.initDocumentEvents();\n\n    // this.freeDraw(canvas);\n\n    this.imageList = this.imageList.map((d) => {\n      return {\n        url: d,\n        rendered: false\n      };\n    });\n\n    let containerDOM;\n    this.$nextTick(() => {\n      containerDOM = this.$refs.image_canvas_wrap;\n      this.conWH = {\n        width: containerDOM.clientWidth,\n        height: containerDOM.clientHeight\n      };\n      this.toNext();\n      // this.addrect();\n    });\n  },\n  methods,\n  props: {\n    config: {\n      default: () => {},\n      type: Object\n    }\n  },\n  data() {\n    const defaultConfig = {\n      colorList: [\"#b92b27\", \"#ee9ca7\", \"#1565C0\", \"#a8ff78\"],\n      color: \"#b92b27\",\n      pencilSizeList: [1, 2, 3, 4],\n      pencilSize: 1,\n      rotateLeft: true,\n      rotateRight: true,\n      zoomIn: true,\n      zoomOut: true,\n      prev: true,\n      next: true\n    };\n    return {\n      canvas: null,\n      conWH: {},\n      historyChanging: false,\n      imageList: imageList,\n      itemList: [],\n      currIndex: -1,\n      currItem: null,\n      panning: false,\n      mode: \"\",\n      freeDrawingBrushWidth: 20,\n      myConfig: Object.assign({}, defaultConfig, this.config),\n      imgUrl: null,\n      imgUrlExport: null\n\n      // colors: {}\n      // statusList: null,\n    };\n  },\n  components: {\n    MenuDrag,\n    MenuPencil,\n    MenuZoom,\n    MenuRestore,\n    MenuRotate,\n    MenuColor,\n    MenuEraser,\n    MenuSwitchImage,\n    MenuDownload,\n    MenuUndo\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n#container {\n  // overflow: hidden;\n}\n#image_canvas_wrap {\n  box-sizing: content-box;\n  width: 800px;\n  height: 600px;\n  margin: 0 auto;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  overflow: auto;\n  background: #fff;\n  background-image: linear-gradient(\n      45deg,\n      #ccc 25%,\n      transparent 25%,\n      transparent 75%,\n      #ccc 75%,\n      #ccc\n    ),\n    linear-gradient(\n      45deg,\n      #ccc 25%,\n      transparent 25%,\n      transparent 75%,\n      #ccc 75%,\n      #ccc\n    );\n  background-size: 24px 24px;\n  background-position: 0 0, 12px 12px;\n  #image_canvas {\n    height: 100%;\n    width: 100%;\n    border: 1px solid red;\n    box-sizing: border-box;\n    display: flex;\n    align-self: center;\n    // border-left: 10px solid red;\n  }\n}\n#menu {\n  width: 800px;\n  height: 50px;\n  position: relative;\n  z-index: 1;\n  background: #485563;\n  /* fallback for old browsers */\n  background: -webkit-linear-gradient(\n    to bottom,\n    #29323c,\n    #485563\n  ); /* Chrome 10-25, Safari 5.1-6 */\n  background: linear-gradient(to bottom, #29323c, #485563);\n  /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */\n  margin: 0 auto;\n  display: flex;\n  align-items: center;\n  .menu_item {\n    flex: 1;\n    position: relative;\n  }\n}\n</style>\n"],"sourceRoot":"src/page"}]}